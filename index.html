<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Korku Hikayeleri Forumu</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">



<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Cinzel', serif;
background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1f 100%);
color: #e0e0e0;
min-height: 100vh;
overflow-x: hidden;
position: relative;
}

body::before {
content: '';
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: repeating-linear-gradient(
0deg,
rgba(255, 0, 0, 0.03) 0px,
rgba(255, 0, 0, 0.03) 1px,
transparent 1px,
transparent 2px
);
pointer-events: none;
z-index: 1;
}

.container {
position: relative;
z-index: 2;
}

/* Navbar */
nav {
background: rgba(10, 10, 10, 0.95);
border-bottom: 2px solid #8b0000;
padding: 1rem 2rem;
display: flex;
justify-content: space-between;
align-items: center;
box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3);
backdrop-filter: blur(10px);
}

.logo {
font-family: 'Creepster', cursive;
font-size: 1.8rem;
color: #ff4444;
text-shadow: 0 0 10px #ff0000, 0 0 20px #8b0000;
cursor: pointer;
transition: all 0.3s ease;
}

.logo:hover {
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
transform: scale(1.05);
}

.nav-menu {
display: flex;
gap: 2rem;
list-style: none;
flex-grow: 1;
justify-content: center;
}

.nav-menu a {
color: #e0e0e0;
text-decoration: none;
padding: 0.5rem 1rem;
border-radius: 5px;
transition: all 0.3s ease;
position: relative;
}

.nav-menu a::before {
content: '';
position: absolute;
bottom: -2px;
left: 0;
width: 0;
height: 2px;
background: #ff4444;
transition: width 0.3s ease;
}

.nav-menu a:hover {
background: rgba(255, 64, 64, 0.2);
}

.nav-menu a:hover::before {
width: 100%;
}

.nav-right {
display: flex;
gap: 1rem;
align-items: center;
}

.user-info {
color: #ff4444;
font-weight: bold;
}

.btn {
padding: 0.7rem 1.5rem;
border: none;
background: linear-gradient(135deg, #8b0000, #ff0000);
color: white;
border-radius: 8px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
font-weight: bold;
}

.btn::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: rgba(255, 255, 255, 0.2);
transition: left 0.3s ease;
}

.btn:hover {
box-shadow: 0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 10px rgba(255, 0, 0, 0.4);
transform: translateY(-2px);
}

.btn:hover::before {
left: 100%;
}

.btn-secondary {
background: rgba(100, 100, 100, 0.8);
border: 1px solid #666;
}

.btn-secondary:hover {
box-shadow: 0 0 15px rgba(150, 150, 150, 0.6);
background: rgba(120, 120, 120, 0.9);
}

/* Modal ve Sayfalar */
.page {
display: none;
animation: fadeIn 0.5s ease;
}

.page.active {
display: block;
}

@keyframes fadeIn {
from {
opacity: 0;
transform: translateY(10px);
}
to {
opacity: 1;
transform: translateY(0);
}
}

.modal {
display: none;
position: fixed;
z-index: 1000;
left: 0;
top: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.7);
backdrop-filter: blur(5px);
animation: fadeIn 0.3s ease;
}

.modal.show {
display: flex;
justify-content: center;
align-items: center;
}

.modal-content {
background: linear-gradient(135deg, #1a1a1a, #2d1b3d);
border: 2px solid #8b0000;
border-radius: 15px;
padding: 2rem;
max-width: 500px;
width: 90%;
box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
animation: slideUp 0.3s ease;
}

@keyframes slideUp {
from {
transform: translateY(50px);
opacity: 0;
}
to {
transform: translateY(0);
opacity: 1;
}
}

.close-btn {
color: #ff4444;
float: right;
font-size: 1.5rem;
font-weight: bold;
cursor: pointer;
transition: all 0.3s ease;
}

.close-btn:hover {
color: #ff0000;
transform: scale(1.2);
}

/* Form Styles */
.form-group {
margin-bottom: 1.5rem;
}

label {
display: block;
margin-bottom: 0.5rem;
color: #ff9999;
font-weight: bold;
}

input, textarea, select {
width: 100%;
padding: 0.8rem;
border: 1px solid #8b0000;
background: rgba(40, 20, 40, 0.8);
color: #e0e0e0;
border-radius: 8px;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
}

input:focus, textarea:focus, select:focus {
outline: none;
border-color: #ff4444;
box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
background: rgba(60, 30, 60, 0.9);
}

/* Ana Sayfa */
.hero {
text-align: center;
padding: 3rem 2rem;
margin: 2rem 0;
background-color: #2d1b3d;
}

.hero h1 {
font-family: 'Creepster', cursive;
font-size: 3.5rem;
color: #ff4444;
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
margin-bottom: 1rem;
animation: glow 2s ease-in-out infinite;
}

@keyframes glow {
0%, 100% {
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
}
50% {
text-shadow: 0 0 30px #ff0000, 0 0 60px #8b0000;
}
}

.hero p {
color: #b0b0b0;
font-size: 1.1rem;
margin-bottom: 2rem;
}

/* Filtreleme */
.filter-section {
background: rgba(20, 10, 20, 0.8);
padding: 2rem;
margin: 2rem 2rem;
border-radius: 10px;
border: 1px solid #8b0000;
box-shadow: 0 4px 15px rgba(139, 0, 0, 0.2);
}

.filter-row {
display: flex;
gap: 1rem;
flex-wrap: wrap;
margin-bottom: 1rem;
}

.filter-row select, .filter-row input {
flex: 1;
min-width: 150px;
}

/* Hikaye Kartlarƒ± */
.stories-section {
padding: 2rem;
display: grid;
grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
gap: 2rem;
max-width: 1400px;
margin: 0 auto;
}

.story-card {
background: linear-gradient(135deg, rgba(30, 10, 30, 0.9), rgba(50, 20, 50, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
padding: 1.5rem;
cursor: pointer;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
}

.story-card::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255, 0, 0, 0.1));
transition: left 0.5s ease;
}

.story-card:hover {
border-color: #ff4444;
box-shadow: 0 0 30px rgba(255, 0, 0, 0.5), inset 0 0 20px rgba(255, 0, 0, 0.1);
transform: translateY(-5px);
}

.story-card:hover::before {
left: 100%;
}

.story-title {
font-size: 1.3rem;
color: #ff9999;
margin-bottom: 0.5rem;
font-weight: bold;
}

.story-preview {
color: #b0b0b0;
font-size: 0.95rem;
margin-bottom: 1rem;
line-height: 1.5;
max-height: 100px;
overflow: hidden;
text-overflow: ellipsis;
}

.story-meta {
display: flex;
justify-content: space-between;
align-items: center;
font-size: 0.85rem;
color: #888;
margin-bottom: 1rem;
flex-wrap: wrap;
gap: 0.5rem;
}

.story-author {
color: #ff6666;
font-weight: bold;
}

.story-actions {
display: flex;
gap: 1rem;
margin-top: 1rem;
}

.action-btn {
flex: 1;
padding: 0.6rem;
background: rgba(139, 0, 0, 0.4);
border: 1px solid #8b0000;
color: #ff9999;
border-radius: 6px;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
gap: 0.5rem;
font-family: 'Cinzel', serif;
font-size: 0.9rem;
}

.action-btn:hover {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
box-shadow: 0 0 10px rgba(255, 0, 0, 0.4);
}

.action-btn.liked {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

        .action-btn.saved {
            background: rgba(255, 200, 0, 0.3);
            color: #ffcc00;
        }

/* Hikaye Detay */
.story-detail {
max-width: 900px;
margin: 2rem auto;
padding: 2rem;
background: linear-gradient(135deg, rgba(20, 10, 20, 0.9), rgba(40, 20, 40, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
box-shadow: 0 4px 20px rgba(139, 0, 0, 0.3);
}

.detail-header {
border-bottom: 2px solid #8b0000;
padding-bottom: 2rem;
margin-bottom: 2rem;
}

.detail-title {
font-size: 2rem;
color: #ff9999;
margin-bottom: 1rem;
font-weight: bold;
}

.detail-meta {
display: flex;
gap: 2rem;
color: #888;
font-size: 0.95rem;
flex-wrap: wrap;
}

.detail-meta span {
display: flex;
gap: 0.5rem;
align-items: center;
}

.detail-content {
color: #d0d0d0;
line-height: 1.8;
margin: 2rem 0;
font-size: 1.05rem;
white-space: pre-wrap;
word-break: break-word;
}

.detail-actions {
display: flex;
gap: 1rem;
margin: 2rem 0;
flex-wrap: wrap;
}

/* Yorum Sistemi */
.comments-section {
margin-top: 3rem;
border-top: 2px solid #8b0000;
padding-top: 2rem;
}

.comments-title {
font-size: 1.5rem;
color: #ff9999;
margin-bottom: 1.5rem;
font-weight: bold;
}

.comment-form {
background: rgba(40, 20, 40, 0.8);
padding: 1.5rem;
border-radius: 10px;
border: 1px solid #663366;
margin-bottom: 2rem;
}

.comment-list {
display: flex;
flex-direction: column;
gap: 1.5rem;
}

.comment-card {
background: rgba(30, 15, 30, 0.8);
padding: 1.5rem;
border-left: 3px solid #8b0000;
border-radius: 8px;
transition: all 0.3s ease;
}

.comment-card:hover {
box-shadow: 0 0 15px rgba(255, 0, 0, 0.2);
border-left-color: #ff4444;
}

.comment-header {
display: flex;
justify-content: space-between;
margin-bottom: 0.8rem;
flex-wrap: wrap;
gap: 1rem;
}

.comment-author {
color: #ff9999;
font-weight: bold;
}

.comment-date {
color: #888;
font-size: 0.85rem;
}

.comment-text {
color: #d0d0d0;
margin-bottom: 1rem;
line-height: 1.6;
white-space: pre-wrap;
word-break: break-word;
}

.comment-actions {
display: flex;
gap: 1rem;
}

.comment-like {
background: rgba(139, 0, 0, 0.3);
border: none;
color: #ff9999;
padding: 0.5rem 1rem;
border-radius: 6px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
display: flex;
align-items: center;
gap: 0.5rem;
}

.comment-like:hover {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

.comment-like.liked {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

/* Kullanƒ±cƒ± Profili */
.profile-section {
max-width: 1000px;
margin: 2rem auto;
padding: 2rem;
}

.profile-header {
background: linear-gradient(135deg, rgba(30, 10, 50, 0.9), rgba(50, 20, 70, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
padding: 2rem;
text-align: center;
margin-bottom: 2rem;
box-shadow: 0 4px 20px rgba(139, 0, 0, 0.3);
}

.profile-avatar {
width: 120px;
height: 120px;
margin: 0 auto 1rem;
background: linear-gradient(135deg, #8b0000, #ff0000);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-size: 3rem;
color: #fff;
border: 3px solid #ff4444;
box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
}

.profile-name {
font-size: 1.8rem;
color: #ff9999;
margin-bottom: 0.5rem;
font-weight: bold;
}

.profile-stats {
display: flex;
justify-content: space-around;
margin-top: 1.5rem;
font-size: 0.9rem;
color: #888;
flex-wrap: wrap;
gap: 1rem;
}

.profile-stat {
text-align: center;
}

.profile-stat-number {
font-size: 1.5rem;
color: #ff9999;
font-weight: bold;
}

/* ƒ∞leti≈üim Bilgileri */
.profile-contact {
display: flex;
justify-content: center;
gap: 2rem;
margin-top: 1.5rem;
flex-wrap: wrap;
}

.contact-item {
display: flex;
align-items: center;
gap: 0.5rem;
color: #b0b0b0;
font-size: 0.95rem;
transition: all 0.3s ease;
}

.contact-item a {
color: #66ccff;
text-decoration: none;
font-weight: bold;
transition: all 0.3s ease;
}

.contact-item a:hover {
color: #ff9999;
text-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
}

.contact-item i {
color: #ff9999;
font-size: 1.2rem;
}

.profile-tabs {
display: flex;
gap: 1rem;
margin-bottom: 2rem;
border-bottom: 2px solid #8b0000;
}

.profile-tab {
padding: 1rem 2rem;
background: transparent;
border: none;
color: #888;
cursor: pointer;
font-family: 'Cinzel', serif;
font-weight: bold;
transition: all 0.3s ease;
position: relative;
}

.profile-tab.active {
color: #ff9999;
}

.profile-tab.active::after {
content: '';
position: absolute;
bottom: -2px;
left: 0;
right: 0;
height: 2px;
background: #ff4444;
}

.profile-content {
display: none;
}

.profile-content.active {
display: block;
}

/* Bo≈ü Durum */
.empty-state {
text-align: center;
padding: 3rem 2rem;
color: #888;
}

.empty-state-icon {
font-size: 3rem;
margin-bottom: 1rem;
color: #8b0000;
}

/* Arama Sonu√ßlarƒ± */
.search-stats {
background: rgba(100, 50, 100, 0.3);
border: 1px solid #8b0000;
padding: 1.5rem;
border-radius: 8px;
margin-bottom: 1.5rem;
display: None;
flex-direction: column;
gap: 1rem;
}

.search-stats.show {
display: flex;
}

.search-stats-header {
display: flex;
justify-content: space-between;
align-items: center;
flex-wrap: wrap;
gap: 1rem;
}

.search-term {
color: #ff9999;
font-weight: bold;
font-size: 1.1rem;
}

.search-count {
background: rgba(139, 0, 0, 0.5);
padding: 0.5rem 1rem;
border-radius: 6px;
color: #ff9999;
font-weight: bold;
}

.search-filters-info {
color: #b0b0b0;
font-size: 0.95rem;
}

.search-filters-info span {
display: inline-block;
margin-right: 1.5rem;
color: #d0d0d0;
}

.clear-search-btn {
padding: 0.5rem 1rem;
background: rgba(100, 50, 50, 0.6);
border: 1px solid #8b0000;
color: #ff9999;
border-radius: 6px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
}

.clear-search-btn:hover {
background: rgba(139, 0, 0, 0.5);
box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
}

.search-input-wrapper {
position: relative;
flex: 1;
min-width: 200px;
}

.search-clear-btn {
position: absolute;
right: 10px;
top: 50%;
transform: translateY(-50%);
background: none;
border: none;
color: #ff9999;
cursor: pointer;
font-size: 1.2rem;
transition: all 0.3s ease;
display: none;
}

.search-clear-btn:hover {
color: #ff4444;
transform: translateY(-50%) scale(1.2);
}

.search-input-wrapper.has-text .search-clear-btn {
display: block;
}

/* Ba≈üarƒ± Mesajƒ± */
.toast {
position: fixed;
bottom: 20px;
right: 20px;
background: rgba(0, 100, 0, 0.9);
color: #90EE90;
padding: 1rem 1.5rem;
border-radius: 8px;
border-left: 4px solid #00FF00;
animation: slideInUp 0.3s ease;
z-index: 2000;
}

/* Footer */
footer {
background: rgba(10, 10, 10, 0.95);
border-top: 2px solid #8b0000;
padding: 2rem;
margin-top: 3rem;
text-align: center;
box-shadow: 0 -4px 15px rgba(139, 0, 0, 0.3);
}

.footer-content {
max-width: 1200px;
margin: 0 auto;
}

.footer-title {
font-family: 'Creepster', cursive;
font-size: 1.5rem;
color: #ff9999;
margin-bottom: 1rem;
text-shadow: 0 0 10px #ff0000;
}

.footer-social {
display: flex;
justify-content: center;
gap: 2rem;
margin-bottom: 1.5rem;
flex-wrap: wrap;
}

.social-link {
display: flex;
align-items: center;
gap: 0.5rem;
color: #b0b0b0;
text-decoration: none;
transition: all 0.3s ease;
padding: 0.8rem 1.5rem;
border: 1px solid #8b0000;
border-radius: 8px;
font-weight: bold;
}

.social-link i {
color: #ff9999;
font-size: 1.2rem;
}

.social-link:hover {
color: #ff9999;
border-color: #ff4444;
background: rgba(139, 0, 0, 0.2);
box-shadow: 0 0 15px rgba(255, 0, 0, 0.2);
transform: translateY(-2px);
}

.footer-text {
color: #888;
font-size: 0.9rem;
border-top: 1px solid #333;
padding-top: 1.5rem;
animation: slideInUp 0.3s ease;
z-index: 2000;
}

@keyframes slideInUp {
from {
transform: translateY(100px);
opacity: 0;
}
to {
transform: translateY(0);
opacity: 1;
}
}

/* Responsive */
@media (max-width: 768px) {
nav {
                flex-direction: column;
                gap: 1rem;
                flex-direction: row;
                gap: 0.5rem;
                padding: 0.8rem 1rem;
                justify-content: space-between;
                align-items: center;
            }

            .logo {
                font-size: 1.2rem;
                order: 1;
}

.nav-menu {
                gap: 1rem;
                font-size: 0.9rem;
                order: 3;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                flex-direction: column;
                gap: 0;
                background: rgba(10, 10, 10, 0.95);
                border-top: 2px solid #8b0000;
                padding: 1rem;
                display: none;
                margin: 0;
            }

            .nav-menu.mobile-open {
                display: flex;
            }

            .nav-menu a {
                padding: 0.8rem;
                border-bottom: 1px solid #333;
            }

            #hamburgerBtn {
                order: 2;
                display: block !important;
}

.hero h1 {
font-size: 2.5rem;
}

.stories-section {
grid-template-columns: 1fr;
}

.filter-row {
flex-direction: column;
}

.filter-row select, .filter-row input {
min-width: auto;
}

.profile-tabs {
flex-wrap: wrap;
}

.profile-tab {
padding: 0.8rem 1rem;
}
}
</style>
</head>
<body>
<!-- Navbar -->
<nav>
<div class="logo" onclick="showPage('home')">
<i class="fas fa-ghost"></i> Korku Forumu
</div>
    
        <ul class="nav-menu" id="mainMenu">
            <li><a href="#" onclick="showPage('home'); resetFilters(); toggleMobileMenu(); return false;">Ana Sayfa</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'newest'; filterStories(); toggleMobileMenu(); return false;">En Yeni</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'popular'; filterStories(); toggleMobileMenu(); return false;">En Pop√ºler</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'mostCommented'; filterStories(); toggleMobileMenu(); return false;">En √áok Yorum</a></li>
</ul>
        <button class="btn btn-secondary" id="hamburgerBtn" style="display: none; order: 2;" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
<div class="nav-right">
<div id="userDisplay" class="user-info"></div>
<button class="btn" onclick="toggleAuth()" id="authBtn">Giri≈ü Yap</button>
<button class="btn" id="profileBtn" style="display: none;" onclick="showUserProfile()">
<i class="fas fa-user"></i> Profil
</button>
<button class="btn btn-secondary" id="logoutBtn" style="display: none;" onclick="logout()">√áƒ±kƒ±≈ü</button>
</div>
</nav>

<!-- Ana Sayfa -->
<div id="home" class="page active">
<div class="hero">

<h1> Korku Hikayeleri Forumu </h1>
<p>Karanlƒ±k ve gerilim dolu hikayelerin bulu≈ütuƒüu yer...</p>
</div>

<div class="filter-section">
<div class="filter-row">
<div class="search-input-wrapper">
<input type="text" id="searchInput" placeholder="Hikaye, yazar adƒ± veya i√ßerik ara..." onkeyup="handleSearchInput()" onchange="filterStories()">
<button class="search-clear-btn" onclick="clearSearch()" title="Temizle">
<i class="fas fa-times"></i>
</button>
</div>
<select id="searchTypeFilter" onchange="filterStories()">
<option value="all">T√ºm Alanlarda</option>
<option value="title">Sadece Ba≈ülƒ±k</option>
<option value="author">Sadece Yazar</option>
<option value="content">Sadece ƒ∞√ßerik</option>
</select>
<select id="categoryFilter" onchange="filterStories()">
<option value="">T√ºm Kategoriler</option>
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
<select id="sortFilter" onchange="filterStories()">
<option value="newest">En Yeni</option>
<option value="popular">En Pop√ºler</option>
<option value="mostCommented">En √áok Yorum</option>
<option value="likes">En √áok Beƒüeni</option>
</select>
</div>

<div class="search-stats" id="searchStats">
<div class="search-stats-header">
<span class="search-term" id="searchTermDisplay"></span>
<span class="search-count" id="resultCount"></span>
<button class="clear-search-btn" onclick="resetFilters()">
<i class="fas fa-refresh"></i> Filtreleri Sƒ±fƒ±rla
</button>
</div>
<div class="search-filters-info" id="filtersInfo"></div>
</div>

<button class="btn" id="addStoryBtn" style="display: none;" onclick="showAddStoryModal()">
<i class="fas fa-plus"></i> Hikaye Ekle
</button>
            <button class="btn btn-secondary" id="libraryBtn" style="display: none;" onclick="showPage('library')">
                <i class="fas fa-bookmark"></i> K√ºt√ºphanem
            </button>
            <button class="btn btn-secondary" id="chatBtn" style="display: none;" onclick="showPage('chat')">
                <i class="fas fa-comments"></i> Sohbet
            </button>
<div style="margin-top: 1rem; text-align: center; color: #888;">
<p id="loginPrompt">Hikaye eklemek i√ßin <a href="#" onclick="toggleAuth(); return false;" style="color: #ff9999; text-decoration: underline;">giri≈ü yapƒ±n</a></p>
</div>
</div>

<div class="stories-section" id="storiesContainer">
<!-- Hikayeler buraya y√ºklenir -->
</div>
</div>

<!-- Hikaye Detay -->
<div id="storyDetail" class="page">
<div class="story-detail">
<button class="btn btn-secondary" onclick="showPage('home')" style="margin-bottom: 2rem;">
<i class="fas fa-arrow-left"></i> Geri D√∂n
</button>
<div class="detail-header">
<h1 class="detail-title" id="detailTitle"></h1>
<div class="detail-meta">
<span><i class="fas fa-user"></i> <span id="detailAuthor"></span></span>
<span><i class="fas fa-calendar"></i> <span id="detailDate"></span></span>
<span><i class="fas fa-tag"></i> <span id="detailCategory"></span></span>
</div>
</div>
<div class="detail-content" id="detailContent"></div>
<div class="detail-actions">
<button class="action-btn" id="likeBtn" onclick="toggleLikeStory()">
<i class="fas fa-heart"></i> <span id="likeCount">0</span> Beƒüeni
</button>
<button class="action-btn" id="commentCountBtn">
<i class="fas fa-comments"></i> <span id="commentCount">0</span> Yorum
</button>
</div>

<!-- Yorum Sistemi -->
<div class="comments-section" id="commentsSection">
<h2 class="comments-title">Yorumlar</h2>

<div class="comment-form" id="commentFormContainer" style="display: none;">
<div class="form-group">
<label>Adƒ±nƒ±z</label>
<input type="text" id="commentName" readonly>
</div>
<div class="form-group">
<label>Yorumunuz</label>
<textarea id="commentText" rows="4" placeholder="D√º≈ü√ºncelerinizi payla≈üƒ±n..."></textarea>
</div>
<button class="btn" onclick="addComment()">
<i class="fas fa-paper-plane"></i> Yorum G√∂nder
</button>
</div>

<div id="commentContainer">
<!-- Yorumlar buraya y√ºklenir -->
</div>
</div>
</div>
</div>

    <!-- K√ºt√ºphane Sayfasƒ± -->
    <div id="library" class="page">
        <div style="text-align: center; padding: 2rem;">
            <h1 style="color: #ff9999; font-size: 2.5rem;"><i class="fas fa-bookmark"></i> Beƒüenilen Hikayeler</h1>
        </div>
        <div id="libraryContainer" style="max-width: 1200px; margin: 2rem auto; padding: 2rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem;">
            <!-- Beƒüenilen hikayeler buraya y√ºklenir -->
        </div>
    </div>

    <!-- Chat Sayfasƒ± -->
    <div id="chat" class="page">
        <div style="text-align: center; padding: 2rem;">
            <h1 style="color: #ff9999; font-size: 2.5rem;"><i class="fas fa-comments"></i> Genel Sohbet</h1>
        </div>
        <div style="max-width: 900px; margin: 2rem auto; padding: 2rem; background: linear-gradient(135deg, rgba(20, 10, 20, 0.9), rgba(40, 20, 40, 0.9)); border: 1px solid #8b0000; border-radius: 12px; display: flex; flex-direction: column; height: 600px;">
            <div id="chatMessages" style="flex: 1; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #8b0000; border-radius: 8px; padding: 1rem; background: rgba(10, 10, 10, 0.8);"></div>
            <div style="display: flex; gap: 0.5rem;">
                <input type="text" id="chatInput" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n..." style="flex: 1; padding: 0.8rem; background: rgba(50, 50, 50, 0.9); border: 1px solid #8b0000; color: #e0e0e0; border-radius: 6px;" onkeypress="handleChatKeyPress(event)">
                <button class="btn" onclick="sendChatMessage()" style="padding: 0.8rem 1.5rem;"><i class="fas fa-paper-plane"></i> G√∂nder</button>
            </div>
        </div>
    </div>

<!-- Kullanƒ±cƒ± Profili -->
<div id="userProfile" class="page">
<div class="profile-section">
<button class="btn btn-secondary" onclick="showPage('home')" style="margin-bottom: 2rem;">
<i class="fas fa-arrow-left"></i> Geri D√∂n
</button>

<div class="profile-header">
<div class="profile-avatar">üëª</div>
<div class="profile-name" id="profileUsername"></div>
<div class="profile-stats">
<div class="profile-stat">
<div class="profile-stat-number" id="profileStoriesCount">0</div>
<div>Payla≈üƒ±lan Hikaye</div>
</div>
<div class="profile-stat">
<div class="profile-stat-number" id="profileCommentsCount">0</div>
<div>Yorum Yapƒ±lan</div>
</div>
<div class="profile-stat">
<div class="profile-stat-number" id="profileLikesCount">0</div>
<div>Alƒ±nan Beƒüeni</div>
</div>
</div>
</div>

<div class="profile-tabs">
<button class="profile-tab active" onclick="switchProfileTab('stories')">
<i class="fas fa-book"></i> Hikayeler
</button>
<button class="profile-tab" onclick="switchProfileTab('comments')">
<i class="fas fa-comments"></i> Yorumlar
</button>
</div>

<div id="storiesTab" class="profile-content active">
<!-- Kullanƒ±cƒ± hikayeler -->
</div>

<div id="commentsTab" class="profile-content">
<!-- Kullanƒ±cƒ± yorumlar -->
</div>
</div>
</div>

<!-- Giri≈ü/Kayƒ±t Modal -->
<div id="authModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="toggleAuth()">&times;</span>

<div id="loginForm">
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
</h2>
<div class="form-group">
<label for="loginUsername">Kullanƒ±cƒ± Adƒ±</label>
<input type="text" id="loginUsername" placeholder="Kullanƒ±cƒ± adƒ±nƒ±z">
</div>
<div class="form-group">
<label for="loginEmail">E-Posta</label>
<input type="text" id="loginEmail" placeholder="E-posta adresiniz">
</div>
<div class="form-group">
<label for="loginPassword">≈ûifre</label>
<input type="password" id="loginPassword" placeholder="≈ûifreniz">
</div>
<button class="btn" style="width: 100%; margin-bottom: 1rem;" onclick="login()">
<i class="fas fa-check"></i> Giri≈ü Yap
</button>
<p style="text-align: center; color: #888;">
Hesabƒ±n yok mu? 
<a href="#" onclick="switchAuthForm(); return false;" style="color: #ff9999;">Kayƒ±t ol</a>
</p>
</div>

<div id="registerForm" style="display: none;">
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-user-plus"></i> Kayƒ±t Ol
</h2>
<div class="form-group">
<label for="registerEmail">E-posta</label>
<input type="email" id="registerEmail" placeholder="E-posta adresiniz">
</div>
<div class="form-group">
<label for="registerPassword">≈ûifre</label>
<input type="password" id="registerPassword" placeholder="En az 6 karakter">
</div>
<button class="btn" style="width: 100%; margin-bottom: 1rem;" onclick="register()">
<i class="fas fa-user-plus"></i> Kayƒ±t Ol
</button>
<p style="text-align: center; color: #888;">
Zaten hesabƒ±n var mƒ±? 
<a href="#" onclick="switchAuthForm(); return false;" style="color: #ff9999;">Giri≈ü yap</a>
</p>
</div>
</div>
</div>

<!-- Hikaye Ekleme Modal -->
<div id="addStoryModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="closeAddStoryModal()">&times;</span>
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-pen-fancy"></i> Yeni Hikaye Ekle
</h2>
<div class="form-group">
<label for="storyTitle">Hikaye Ba≈ülƒ±ƒüƒ±</label>
<input type="text" id="storyTitle" placeholder="Hikayenizin ba≈ülƒ±ƒüƒ±">
</div>
<div class="form-group">
<label for="storyCategory">Kategori</label>
<select id="storyCategory">
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
</div>
<div class="form-group">
<label for="storyContent">Hikaye ƒ∞√ßeriƒüi</label>
<textarea id="storyContent" rows="6" placeholder="Hikayenizi buraya yazƒ±nƒ±z..."></textarea>
</div>
<button class="btn" style="width: 100%;" onclick="addStory()">
<i class="fas fa-upload"></i> Hikayeyi Payla≈ü
</button>
</div>
</div>

<!-- Hikaye D√ºzenleme Modal -->
<div id="editStoryModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="app.closeEditStoryModal()">&times;</span>
<h2 style="color: #66ccff; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-edit"></i> Hikaye D√ºzenle
</h2>
<div class="form-group">
<label for="editStoryTitle">Hikaye Ba≈ülƒ±ƒüƒ±</label>
<input type="text" id="editStoryTitle" placeholder="Hikayenizin ba≈ülƒ±ƒüƒ±">
</div>
<div class="form-group">
<label for="editStoryCategory">Kategori</label>
<select id="editStoryCategory">
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
</div>
<div class="form-group">
<label for="editStoryContent">Hikaye ƒ∞√ßeriƒüi</label>
<textarea id="editStoryContent" rows="6" placeholder="Hikayenizi buraya yazƒ±nƒ±z..."></textarea>
</div>
<div style="display: flex; gap: 1rem;">
<button class="btn" style="flex: 1;" onclick="app.saveEditStory()">
<i class="fas fa-save"></i> Kaydet
</button>
<button class="btn btn-secondary" style="flex: 1;" onclick="app.closeEditStoryModal()">
<i class="fas fa-times"></i> ƒ∞ptal
</button>
</div>
</div>
</div>

<script>
// ===== VERƒ∞ Y√ñNETƒ∞Mƒ∞ =====
class ForumApp {
constructor() {
this.users = JSON.parse(localStorage.getItem('users')) || [];

                // ƒ∞lk kez ise admin hesabƒ± ekle
                // ƒ∞lk kez ise admin ve demo hesabƒ± ekle
if (this.users.length === 0) {
this.users.push({ 
username: 'admin', 
email: 'admin@forum.com', 
                        password: 'sshs693434',
                        password: 'admin123',
instagram: 'emirslmn_',
github: 'ermirhansalman4'
});
                    this.users.push({ 
                        username: 'demo', 
                        email: 'demo@test.com', 
                        password: 'demo123'
                    });
}

// currentUser yoksa null - giri≈ü yapmasƒ± gerek
this.currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

this.allStories = JSON.parse(localStorage.getItem('stories')) || this.getInitialStories();
this.stories = this.allStories.slice(); // A√ßƒ±k√ßa kopyala
this.comments = JSON.parse(localStorage.getItem('comments')) || [];
this.currentStoryId = null;
this.searchActive = false;
this.editingStoryId = null;
                this.chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];
                this.savedStoryIds = JSON.parse(localStorage.getItem('savedStoryIds')) || [];
this.init();
}

getInitialStories() {
return [
{
id: 1,
title: "Eski Evin Sƒ±rrƒ±",
content: "Yeni ta≈üƒ±ndƒ±ƒüƒ±m evin bodrum katƒ±nda bir oda buldum. Kapƒ±sƒ± kilitliydi. Her gece oradan garip sesler geliyordu. Merakla kilit a√ßmaya √ßalƒ±≈ütƒ±m. Kapƒ± a√ßƒ±ldƒ± ve i√ßeride... (Devamƒ±nƒ± g√∂rmek i√ßin tƒ±klayƒ±n)",
author: "Admin",
category: "Gizemli",
date: new Date(Date.now() - 86400000 * 2).toLocaleString('tr-TR'),
likes: 15,
liked: false
},
{
id: 2,
title: "√ñdenmeyen Bor√ß",
content: "Bir gece, kapƒ±ma tuhaf bir mektup i√ßeri ge√ßti. 'Borcunuz √∂denmeyecek. Bedeli √ßok aƒüƒ±r olacak' yazƒ±yordu. Ne borcum vardƒ± ne bilemiyordum fakat bitti. Ertesi g√ºn, benimle aynƒ± adƒ± ta≈üƒ±yan √∂l√º bulundu.\n\nMektup devam ediyordu...",
author: "Admin",
category: "√úrk√ºt√ºc√º",
date: new Date(Date.now() - 86400000).toLocaleString('tr-TR'),
likes: 8,
liked: false
},
{
id: 3,
title: "Aynada G√∂rd√ºƒü√ºm ≈ûey",
content: "Sabah aynaya baktƒ±ƒüƒ±mda y√ºz√ºm√º tanƒ±madƒ±m. Tam benim gibi, ama g√∂zleri farklƒ±ydƒ±. √áok eski g√∂r√ºn√ºyordu. Elleriyle bana dokunmaya √ßalƒ±≈ütƒ±... Ve ben geriye adƒ±m attƒ±ƒüƒ±mda ayna patladƒ±.",
author: "Admin",
category: "Kƒ±sa Hikaye",
date: new Date(Date.now() - 86400000 * 3).toLocaleString('tr-TR'),
likes: 22,
liked: false
}
];
}

init() {
this.updateUI();
this.renderStories();
}

updateUI() {
const userDisplay = document.getElementById('userDisplay');
const authBtn = document.getElementById('authBtn');
const profileBtn = document.getElementById('profileBtn');
const logoutBtn = document.getElementById('logoutBtn');
const addStoryBtn = document.getElementById('addStoryBtn');
                const libraryBtn = document.getElementById('libraryBtn');
                const chatBtn = document.getElementById('chatBtn');
const loginPrompt = document.getElementById('loginPrompt');

if (this.currentUser) {
userDisplay.textContent = `üëª ${this.currentUser.username}`;
authBtn.style.display = 'none';
profileBtn.style.display = 'block';
logoutBtn.style.display = 'block';
addStoryBtn.style.display = 'block';
                    libraryBtn.style.display = 'block';
                    chatBtn.style.display = 'block';
loginPrompt.style.display = 'none';
} else {
userDisplay.textContent = '';
authBtn.style.display = 'block';
profileBtn.style.display = 'none';
logoutBtn.style.display = 'none';
addStoryBtn.style.display = 'none';
                    libraryBtn.style.display = 'none';
                    chatBtn.style.display = 'none';
loginPrompt.style.display = 'block';
}
}

save() {
localStorage.setItem('users', JSON.stringify(this.users));
localStorage.setItem('stories', JSON.stringify(this.allStories));
localStorage.setItem('comments', JSON.stringify(this.comments));
localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
                localStorage.setItem('chatMessages', JSON.stringify(this.chatMessages));
                localStorage.setItem('savedStoryIds', JSON.stringify(this.savedStoryIds));
}

deleteStory(storyId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === storyId);
if (!story) return;

if (this.currentUser.username !== 'admin' && story.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi hikayelerinizi silebilirsiniz!');
return;
}

if (confirm(`"${story.title}" hikayesini silmek istediƒüinize emin misiniz?`)) {
this.allStories = this.allStories.filter(s => s.id !== storyId);
this.stories = this.stories.filter(s => s.id !== storyId);
this.comments = this.comments.filter(c => c.storyId !== storyId);
this.save();
this.renderStories();
showToast('Hikaye silindi!');
}
}

editStory(storyId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === storyId);
if (!story) return;

if (this.currentUser.username !== 'admin' && story.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi hikayelerinizi d√ºzenleyebilirsiniz!');
return;
}

this.editingStoryId = storyId;
document.getElementById('editStoryTitle').value = story.title;
document.getElementById('editStoryCategory').value = story.category;
document.getElementById('editStoryContent').value = story.content;
document.getElementById('editStoryModal').classList.add('show');
}

saveEditStory() {
if (!this.editingStoryId) return;

const title = document.getElementById('editStoryTitle').value.trim();
const category = document.getElementById('editStoryCategory').value;
const content = document.getElementById('editStoryContent').value.trim();

if (!title || !content) {
showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
return;
}

const story = this.allStories.find(s => s.id === this.editingStoryId);
if (story) {
story.title = title;
story.category = category;
story.content = content;
this.save();
this.stories = this.allStories.slice();
this.renderStories();
this.closeEditStoryModal();
showToast('Hikaye g√ºncellendi!');
}
}

closeEditStoryModal() {
document.getElementById('editStoryModal').classList.remove('show');
this.editingStoryId = null;
}

renderStories() {
const container = document.getElementById('storiesContainer');
container.innerHTML = '';

if (this.stories.length === 0) {
container.innerHTML = `
                       <div style="grid-column: 1/-1;">
                           <div class="empty-state">
                               <div class="empty-state-icon">üìñ</div>
                               <h3>Hi√ß Hikaye Yok</h3>
                               <p>ƒ∞lk hikayeyi sen payla≈ü ve forumu ba≈ülat!</p>
                           </div>
                       </div>
                   `;
return;
}

this.stories.forEach(story => {
const commentCount = this.comments.filter(c => c.storyId === story.id).length;
const card = document.createElement('div');
card.className = 'story-card';
const isAdmin = this.currentUser && (this.currentUser.username === 'admin' || story.author === this.currentUser.username);
let adminButtons = '';

if (isAdmin) {
adminButtons = `
                           <button class="action-btn" style="background: rgba(100, 150, 255, 0.3); color: #66ccff;" onclick="app.editStory(${story.id})" title="D√ºzenle">
                               <i class="fas fa-edit"></i> D√ºzenle
                           </button>
                           <button class="action-btn" style="background: rgba(255, 100, 100, 0.3); color: #ff6666;" onclick="app.deleteStory(${story.id})" title="Sil">
                               <i class="fas fa-trash"></i> Sil
                           </button>
                       `;
}

card.innerHTML = `
                       <div class="story-title">${this.escapeHtml(story.title)}</div>
                       <div class="story-preview">${this.escapeHtml(story.content.substring(0, 150))}</div>
                       <div class="story-meta">
                           <span class="story-author">${this.escapeHtml(story.author)}</span>
                           <span>${story.date}</span>
                       </div>
                       <div class="story-actions">
                           <button class="action-btn" onclick="app.viewStory(${story.id})">
                               <i class="fas fa-eye"></i> Oku (${commentCount})
                           </button>
                           <button class="action-btn ${story.liked ? 'liked' : ''}" onclick="app.toggleLike(${story.id})">
                               <i class="fas fa-heart"></i> ${story.likes}
                           </button>
                            <button class="action-btn ${this.savedStoryIds.includes(story.id) ? 'saved' : ''}" onclick="app.toggleSaveStory(${story.id})" title="Kaydet">
                                <i class="fas fa-bookmark"></i>
                            </button>
                           ${adminButtons}
                       </div>
                   `;
container.appendChild(card);
});
}

filterAndSortStories() {
const search = document.getElementById('searchInput').value.toLowerCase();
const searchType = document.getElementById('searchTypeFilter').value;
const category = document.getElementById('categoryFilter').value;
const sort = document.getElementById('sortFilter').value;

// Orijinal verjden ba≈üla
let filtered = this.allStories.slice();

// Arama filtresi
if (search) {
this.searchActive = true;
filtered = filtered.filter(story => {
const titleMatch = story.title.toLowerCase().includes(search);
const authorMatch = story.author.toLowerCase().includes(search);
const contentMatch = story.content.toLowerCase().includes(search);

if (searchType === 'title') {
return titleMatch;
} else if (searchType === 'author') {
return authorMatch;
} else if (searchType === 'content') {
return contentMatch;
} else {
// 'all' - t√ºm alanlarda
return titleMatch || authorMatch || contentMatch;
}
});
} else {
this.searchActive = false;
}

// Kategori filtresi
if (category) {
filtered = filtered.filter(story => story.category === category);
}

// Sƒ±ralama
if (sort === 'newest') {
filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
} else if (sort === 'popular') {
filtered.sort((a, b) => b.likes - a.likes);
} else if (sort === 'mostCommented') {
filtered.sort((a, b) => {
const aComments = this.comments.filter(c => c.storyId === a.id).length;
const bComments = this.comments.filter(c => c.storyId === b.id).length;
return bComments - aComments;
});
} else if (sort === 'likes') {
filtered.sort((a, b) => b.likes - a.likes);
}

// Orijinal veri kesinlikle korunur
this.stories = filtered;
this.renderStories();
this.updateSearchStats();
}

updateSearchStats() {
const statsContainer = document.getElementById('searchStats');
const search = document.getElementById('searchInput').value.toLowerCase();
const category = document.getElementById('categoryFilter').value;
const searchType = document.getElementById('searchTypeFilter').value;

if (search || category || searchType !== 'all') {
statsContainer.classList.add('show');

// Arama terimi
if (search) {
document.getElementById('searchTermDisplay').innerHTML = 
`üîç <strong>"${this.escapeHtml(search)}"</strong> arandƒ±`;
} else {
document.getElementById('searchTermDisplay').innerHTML = 'üîç Filtreler uygulandƒ±';
}

// Sonu√ß sayƒ±sƒ±
const count = this.stories.length;
document.getElementById('resultCount').innerHTML = 
`<i class="fas fa-book"></i> ${count} hikaye bulundu`;

// Filtre bilgileri
let filterInfo = '';
if (search) {
const searchTypeLabel = {
'all': 'T√ºm Alanlarda',
'title': 'Ba≈ülƒ±kta',
'author': 'Yazarda',
'content': 'ƒ∞√ßerikte'
};
filterInfo += `<span><i class="fas fa-search"></i> Arama T√ºr√º: ${searchTypeLabel[searchType]}</span>`;
}
if (category) {
filterInfo += `<span><i class="fas fa-tag"></i> Kategori: ${category}</span>`;
}

const sortLabels = {
'newest': 'En Yeni',
'popular': 'En Pop√ºler',
'mostCommented': 'En √áok Yorum',
'likes': 'En √áok Beƒüeni'
};
const sortValue = document.getElementById('sortFilter').value;
filterInfo += `<span><i class="fas fa-sort"></i> Sƒ±ralama: ${sortLabels[sortValue]}</span>`;

document.getElementById('filtersInfo').innerHTML = filterInfo;
} else {
statsContainer.classList.remove('show');
}
}

toggleLike(storyId) {
const story = this.allStories.find(s => s.id === storyId);
if (story) {
story.liked = !story.liked;
story.likes += story.liked ? 1 : -1;
this.save();
this.renderStories();
}
}

addNewStory(title, category, content) {
if (!this.currentUser || !title.trim() || !content.trim()) {
showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
return false;
}

const id = Math.max(...this.allStories.map(s => s.id), 0) + 1;
const story = {
id,
title,
content,
author: this.currentUser.username,
category,
date: new Date().toLocaleString('tr-TR'),
likes: 0,
liked: false
};

this.allStories.unshift(story);
this.stories = this.allStories.slice();
this.save();
this.renderStories();
showToast('Hikaye ba≈üarƒ±yla payla≈üƒ±ldƒ±!');
return true;
}

viewStory(storyId) {
this.currentStoryId = storyId;
const story = this.allStories.find(s => s.id === storyId);

if (story) {
document.getElementById('detailTitle').textContent = story.title;
document.getElementById('detailAuthor').textContent = story.author;
document.getElementById('detailDate').textContent = story.date;
document.getElementById('detailCategory').textContent = story.category;
document.getElementById('detailContent').textContent = story.content;
document.getElementById('likeCount').textContent = story.likes;

const commentCount = this.comments.filter(c => c.storyId === storyId).length;
document.getElementById('commentCount').textContent = commentCount;

const likeBtn = document.getElementById('likeBtn');
if (story.liked) {
likeBtn.classList.add('liked');
} else {
likeBtn.classList.remove('liked');
}

// Yorum formu
const commentFormContainer = document.getElementById('commentFormContainer');
if (this.currentUser) {
commentFormContainer.style.display = 'block';
document.getElementById('commentName').value = this.currentUser.username;
} else {
commentFormContainer.style.display = 'none';
}

this.renderComments(storyId);
showPage('storyDetail');
}
}

toggleLikeStory() {
if (!this.currentUser) {
showToast('Beƒüenmek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === this.currentStoryId);
if (story) {
story.liked = !story.liked;
story.likes += story.liked ? 1 : -1;
document.getElementById('likeCount').textContent = story.likes;

const likeBtn = document.getElementById('likeBtn');
if (story.liked) {
likeBtn.classList.add('liked');
} else {
likeBtn.classList.remove('liked');
}

this.save();
this.renderStories();
}
}

renderComments(storyId) {
const container = document.getElementById('commentContainer');
container.innerHTML = '';

const storyComments = this.comments.filter(c => c.storyId === storyId)
.sort((a, b) => new Date(b.date) - new Date(a.date));

if (storyComments.length === 0) {
container.innerHTML = '<div class="empty-state"><p>Hen√ºz yorum yapƒ±lmamƒ±≈ü. ƒ∞lk yorumu sen yap!</p></div>';
return;
}

storyComments.forEach(comment => {
const card = document.createElement('div');
card.className = 'comment-card';
const isAdmin = this.currentUser && (this.currentUser.username === 'admin' || comment.author === this.currentUser.username);
let adminButtons = '';

if (isAdmin) {
adminButtons = `
                           <button class="comment-like" style="background: rgba(255, 100, 100, 0.3); color: #ff6666; margin-left: 0.5rem;" onclick="app.deleteComment(${comment.id})" title="Sil">
                               <i class="fas fa-trash"></i> Sil
                           </button>
                       `;
}

card.innerHTML = `
                       <div class="comment-header">
                           <span class="comment-author">${this.escapeHtml(comment.author)}</span>
                           <span class="comment-date">${comment.date}</span>
                       </div>
                       <div class="comment-text">${this.escapeHtml(comment.text)}</div>
                       <div class="comment-actions">
                           <button class="comment-like ${comment.liked ? 'liked' : ''}" onclick="app.toggleCommentLike(${comment.id})">
                               <i class="fas fa-heart"></i> ${comment.likes}
                           </button>
                           ${adminButtons}
                       </div>
                   `;
container.appendChild(card);
});
}

deleteComment(commentId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const comment = this.comments.find(c => c.id === commentId);
if (!comment) return;

if (this.currentUser.username !== 'admin' && comment.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi yorumlarƒ±nƒ±zƒ± silebilirsiniz!');
return;
}

if (confirm('Yorumu silmek istediƒüinize emin misiniz?')) {
this.comments = this.comments.filter(c => c.id !== commentId);
this.save();
this.renderComments(this.currentStoryId);
showToast('Yorum silindi!');
}
}

addNewComment(text) {
if (!this.currentUser) {
showToast('Yorum yapmak i√ßin giri≈ü yapƒ±nƒ±z!');
return false;
}

if (!text.trim()) {
showToast('Yorum yazƒ±nƒ±z!');
return false;
}

const id = Math.max(...this.comments.map(c => c.id), 0) + 1;
const comment = {
id,
storyId: this.currentStoryId,
author: this.currentUser.username,
text,
date: new Date().toLocaleString('tr-TR'),
likes: 0,
liked: false
};

this.comments.push(comment);
this.save();
this.renderComments(this.currentStoryId);

const commentCount = this.comments.filter(c => c.storyId === this.currentStoryId).length;
document.getElementById('commentCount').textContent = commentCount;

return true;
}

toggleCommentLike(commentId) {
if (!this.currentUser) {
showToast('Beƒüenmek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}

const comment = this.comments.find(c => c.id === commentId);
if (comment) {
comment.liked = !comment.liked;
comment.likes += comment.liked ? 1 : -1;
this.save();
this.renderComments(this.currentStoryId);
}
}

getUserProfile(username) {
const user = this.users.find(u => u.username === username);
const userStories = this.allStories.filter(s => s.author === username);
const userComments = this.comments.filter(c => c.author === username);

let userLikesCount = 0;
userStories.forEach(story => {
userLikesCount += story.likes;
});
userComments.forEach(comment => {
userLikesCount += comment.likes;
});

return {
username,
stories: userStories,
comments: userComments,
likesCount: userLikesCount,
stats: {
stories: userStories.length,
comments: userComments.length,
likes: userLikesCount
}
};
}

renderUserProfile(username) {
const profile = this.getUserProfile(username);

document.getElementById('profileUsername').textContent = username;
document.getElementById('profileStoriesCount').textContent = profile.stats.stories;
document.getElementById('profileCommentsCount').textContent = profile.stats.comments;
document.getElementById('profileLikesCount').textContent = profile.stats.likes;

// Hikayeler sekmesi
const storiesTab = document.getElementById('storiesTab');
storiesTab.innerHTML = '';

if (profile.stories.length === 0) {
storiesTab.innerHTML = '<div class="empty-state"><p>Hen√ºz hikaye payla≈üƒ±lmamƒ±≈ü</p></div>';
} else {
profile.stories.forEach(story => {
const commentCount = this.comments.filter(c => c.storyId === story.id).length;
const card = document.createElement('div');
card.className = 'story-card';
card.style.marginBottom = '1rem';
card.innerHTML = `
                           <div class="story-title">${this.escapeHtml(story.title)}</div>
                           <div class="story-preview">${this.escapeHtml(story.content.substring(0, 150))}</div>
                           <div class="story-meta">
                               <span>${story.date}</span>
                               <span>${story.category}</span>
                           </div>
                           <button class="btn" style="width: 100%; margin-top: 1rem;" onclick="app.viewStory(${story.id})">
                               <i class="fas fa-eye"></i> Hikayeyi Oku
                           </button>
                       `;
storiesTab.appendChild(card);
});
}

// Yorumlar sekmesi
const commentsTab = document.getElementById('commentsTab');
commentsTab.innerHTML = '';

if (profile.comments.length === 0) {
commentsTab.innerHTML = '<div class="empty-state"><p>Hen√ºz yorum yapƒ±lmamƒ±≈ü</p></div>';
} else {
profile.comments.forEach(comment => {
const card = document.createElement('div');
card.className = 'comment-card';
card.style.marginBottom = '1rem';
card.innerHTML = `
                           <div class="comment-header">
                               <span class="comment-date">${comment.date}</span>
                           </div>
                           <div class="comment-text">${this.escapeHtml(comment.text)}</div>
                           <button class="btn btn-secondary" style="width: 100%; margin-top: 1rem;" onclick="app.viewStory(${comment.storyId})">
                               <i class="fas fa-arrow-right"></i> Hikayeyi Oku
                           </button>
                       `;
commentsTab.appendChild(card);
});
}
}

            addChatMessage(text) {
                if (!this.currentUser || !text.trim()) return;
                const msg = {
                    id: Date.now(),
                    author: this.currentUser.username,
                    text: text.trim(),
                    date: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })
                };
                this.chatMessages.push(msg);
                this.save();
                this.renderChat();
            }

            renderChat() {
                const container = document.getElementById('chatMessages');
                if (!container) return;
                container.innerHTML = '';
                this.chatMessages.slice(-50).forEach(msg => {
                    const div = document.createElement('div');
                    div.style.cssText = 'margin-bottom: 1rem; padding: 0.8rem; background: rgba(100, 50, 100, 0.3); border-left: 3px solid #ff9999; border-radius: 6px;';
                    div.innerHTML = `
                        <div style="color: #ff9999; font-weight: bold; font-size: 0.9rem;"><i class="fas fa-user-circle"></i> ${this.escapeHtml(msg.author)}</div>
                        <div style="color: #d0d0d0; margin-top: 0.3rem; word-break: break-word;">${this.escapeHtml(msg.text)}</div>
                        <div style="color: #888; font-size: 0.8rem; margin-top: 0.3rem;">${msg.date}</div>
                    `;
                    container.appendChild(div);
                });
                container.scrollTop = container.scrollHeight;
            }

            toggleSaveStory(storyId) {
                if (!this.currentUser) {
                    showToast('Kaydetmek i√ßin giri≈ü yapƒ±nƒ±z!');
                    return;
                }
                const idx = this.savedStoryIds.indexOf(storyId);
                if (idx > -1) {
                    this.savedStoryIds.splice(idx, 1);
                    showToast('K√ºt√ºphaneden kaldƒ±rƒ±ldƒ±');
                } else {
                    this.savedStoryIds.push(storyId);
                    showToast('K√ºt√ºphaneye eklendi');
                }
                this.save();
                this.renderLibrary();
                this.renderStories();
            }

            renderLibrary() {
                const container = document.getElementById('libraryContainer');
                if (!container) return;
                container.innerHTML = '';
                
                if (!this.currentUser) {
                    container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><p>Giri≈ü yapƒ±nƒ±z</p></div>';
                    return;
                }

                const savedStories = this.allStories.filter(s => this.savedStoryIds.includes(s.id));

                if (savedStories.length === 0) {
                    container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><p>Hen√ºz kaydedilmi≈ü hikaye yok</p></div>';
                    return;
                }

                savedStories.forEach(story => {
                    const card = document.createElement('div');
                    card.className = 'story-card';
                    card.innerHTML = `
                        <div class="story-title">${this.escapeHtml(story.title)}</div>
                        <div class="story-preview">${this.escapeHtml(story.content.substring(0, 100))}</div>
                        <div class="story-meta">
                            <span class="story-author">${this.escapeHtml(story.author)}</span>
                        </div>
                        <div class="story-actions">
                            <button class="action-btn" onclick="app.viewStory(${story.id})" style="flex: 1;">
                                <i class="fas fa-eye"></i> Oku
                            </button>
                            <button class="action-btn saved" onclick="app.toggleSaveStory(${story.id})" style="flex: 1;">
                                <i class="fas fa-trash"></i> √áƒ±kar
                            </button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

escapeHtml(text) {
const map = {
'&': '&amp;',
'<': '&lt;',
'>': '&gt;',
'"': '&quot;',
"'": '&#039;'
};
return text.replace(/[&<>"']/g, m => map[m]);
}
}

/// ===== KULLANICI ƒ∞≈ûLEMLERƒ∞ =====
async function login() {
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;

    if (!email || !password) {
        showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
        return;
    }

    try {
        // Yeni SDK'da login bu ≈üekilde yapƒ±lƒ±r:
        const session = await account.createSession(email, password);

        const user = await account.get();
        app.currentUser = user;
        app.save();
        app.updateUI();
        toggleAuth();

        showToast(`Ho≈ügeldiniz ${user.name || email}!`);

    } catch (error) {
        showToast('Giri≈ü hatasƒ±: ' + error.message);
    }
}


// Formu temizle
document.getElementById('loginUsername').value = '';
document.getElementById('loginPassword').value = '';


async function register() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;

    if (!username || !email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        await account.create(
            Appwrite.ID.unique(),
            email,
            password,
            username // displayName olarak kaydediliyor
        );

        showToast("Kayƒ±t ba≈üarƒ±lƒ±! ≈ûimdi giri≈ü yapabilirsiniz.");
        toggleAuth();

    } catch (error) {
        showToast("Hata: " + error.message);
    }
// Formu temizle
document.getElementById('registerUsername').value = '';
document.getElementById('registerEmail').value = '';
document.getElementById('registerPassword').value = '';
}

function logout() {
app.currentUser = null;
app.save();
app.updateUI();
showPage('home');
showToast('√áƒ±kƒ±≈ü yapƒ±ldƒ±!');
}

function toggleAuth() {
const modal = document.getElementById('authModal');
modal.classList.toggle('show');
}

function switchAuthForm() {
document.getElementById('loginForm').style.display = 
document.getElementById('loginForm').style.display === 'none' ? 'block' : 'none';
document.getElementById('registerForm').style.display = 
document.getElementById('registerForm').style.display === 'none' ? 'block' : 'none';
}

// ===== Hƒ∞KAYE ƒ∞≈ûLEMLERƒ∞ =====
function showAddStoryModal() {
if (!app.currentUser) {
showToast('Hikaye eklemek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}
document.getElementById('addStoryModal').classList.add('show');
}

function closeAddStoryModal() {
document.getElementById('addStoryModal').classList.remove('show');
document.getElementById('storyTitle').value = '';
document.getElementById('storyContent').value = '';
}

function addStory() {
const title = document.getElementById('storyTitle').value.trim();
const category = document.getElementById('storyCategory').value;
const content = document.getElementById('storyContent').value.trim();

if (app.addNewStory(title, category, content)) {
closeAddStoryModal();
showPage('home');
}
}

function filterStories() {
app.filterAndSortStories();
}

function handleSearchInput() {
const searchInput = document.getElementById('searchInput');
const wrapper = searchInput.parentElement;

if (searchInput.value) {
wrapper.classList.add('has-text');
} else {
wrapper.classList.remove('has-text');
}
}

function clearSearch() {
document.getElementById('searchInput').value = '';
const wrapper = document.getElementById('searchInput').parentElement;
wrapper.classList.remove('has-text');
filterStories();
}

function resetFilters() {
document.getElementById('searchInput').value = '';
document.getElementById('searchTypeFilter').value = 'all';
document.getElementById('categoryFilter').value = '';
document.getElementById('sortFilter').value = 'newest';

const wrapper = document.getElementById('searchInput').parentElement;
wrapper.classList.remove('has-text');

filterStories();
showToast('Filtreleri sƒ±fƒ±rlandƒ±!');
}

function filterByCategory(category) {
if (category === 'T√ºm') {
document.getElementById('categoryFilter').value = '';
} else {
document.getElementById('categoryFilter').value = category;
}
filterStories();
}

// ===== YORUM ƒ∞≈ûLEMLERƒ∞ =====
function addComment() {
const text = document.getElementById('commentText').value.trim();
if (app.addNewComment(text)) {
document.getElementById('commentText').value = '';
}
}

// ===== SAYFA NAVƒ∞GASYONU =====
function showPage(pageName) {
document.querySelectorAll('.page').forEach(page => {
page.classList.remove('active');
});
            
            // Sayfaya √∂zel i≈ülemler
            if (pageName === 'library') {
                app.renderLibrary();
            } else if (pageName === 'chat') {
                app.renderChat();
            } else if (pageName === 'home') {
                app.filterAndSortStories();
            }
            
document.getElementById(pageName).classList.add('active');

// Modal'larƒ± kapat
document.getElementById('authModal').classList.remove('show');
document.getElementById('addStoryModal').classList.remove('show');
}

function showUserProfile() {
if (app.currentUser) {
app.renderUserProfile(app.currentUser.username);
showPage('userProfile');
}
}

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value;
            if (text.trim()) {
                app.addChatMessage(text);
                input.value = '';
            }
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                sendChatMessage();
                event.preventDefault();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mainMenu');
            menu.classList.toggle('mobile-open');
        }

// ===== PROFILE SEKMELER =====
function switchProfileTab(tab) {
document.querySelectorAll('.profile-tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('.profile-content').forEach(c => c.classList.remove('active'));

event.target.closest('.profile-tab').classList.add('active');
document.getElementById(tab + 'Tab').classList.add('active');
}

// ===== UTILS =====
function showToast(message) {
const toast = document.createElement('div');
toast.className = 'toast';
toast.textContent = message;
document.body.appendChild(toast);

setTimeout(() => {
toast.remove();
}, 3000);
}

// ===== ƒ∞Nƒ∞Tƒ∞YALƒ∞ZASYON =====
let app;
document.addEventListener('DOMContentLoaded', () => {
app = new ForumApp();

// Modal dƒ±≈üƒ±na tƒ±klama
document.getElementById('authModal').addEventListener('click', (e) => {
if (e.target.id === 'authModal') toggleAuth();
});

document.getElementById('addStoryModal').addEventListener('click', (e) => {
if (e.target.id === 'addStoryModal') closeAddStoryModal();
});

document.getElementById('editStoryModal').addEventListener('click', (e) => {
if (e.target.id === 'editStoryModal') app.closeEditStoryModal();
});

// Enter tu≈üu
document.getElementById('commentText').addEventListener('keydown', (e) => {
if (e.ctrlKey && e.key === 'Enter') {
addComment();
}
});
});

// Beƒüeni toggle (detail sayfasƒ±nda)
function toggleLikeStory() {
app.toggleLikeStory();
}
</script>



<!-- Footer -->
<footer>
<div class="footer-content">
<div class="footer-title">
<i class="fas fa-user-circle"></i> Korku Forumu Sahibi
</div>
<div class="footer-social">
<a href="https://instagram.com/emirslmn_" target="_blank" class="social-link" title="Instagram">
<i class="fab fa-instagram"></i>
Instagram
</a>
<a href="https://github.com/ermirhansalman4" target="_blank" class="social-link" title="GitHub">
<i class="fab fa-github"></i>
GitHub
</a>
</div>
<div class="footer-text">
<p>¬© 2026 Korku Hikayeleri Forumu - T√ºm Haklarƒ± Saklƒ±dƒ±r</p>
</div>
</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/appwrite@8.6.0/dist/appwrite.min.js"></script>

<script>
const { Client, Account, Databases, ID } = Appwrite;

const client = new Appwrite.Client()
    .setEndpoint("https://cloud.appwrite.io/v1")
    .setProject("698ddf380033ce2ca5d7");
    
    

const account = new Appwrite.Account(client);
const databases = new Databases(client);

const DATABASE_ID = "698de2e0003c0f3283ae";
const STORIES_COLLECTION_ID = "stories";
const COMMENTS_COLLECTION_ID = "comments";
</script>
<script>

// ===== REGISTER =====
async function register() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;

    if (!username || !email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        await account.create(
            Appwrite.ID.unique(), // benzersiz kullanƒ±cƒ± ID
            email,
            password,
            username // displayName olarak kaydediliyor
        );

        showToast("Kayƒ±t ba≈üarƒ±lƒ±! ≈ûimdi giri≈ü yapabilirsiniz.");
        toggleAuth();
    } catch (error) {
        showToast("Hata: " + error.message);
    }
}


// ===== LOGIN =====
async function login() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;


    if (!email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        // 8.6.0 s√ºr√ºm√ºnde login
        await account.createSession(email, password);

        const user = await account.get();
        app.currentUser = user;
        app.save();
        app.updateUI();
        toggleAuth();

        showToast(`Ho≈ügeldiniz ${user.name || email}!`);
    } catch (error) {
        showToast("Giri≈ü hatasƒ±: " + error.message);
    }
}

// ===== LOGOUT =====
async function logout() {
    try {
        await account.deleteSession("current");
        location.reload();
    } catch (error) {
        showToast("√áƒ±kƒ±≈ü hatasƒ±: " + error.message);
    }
}

</script>


</body>
</html><!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Korku Hikayeleri Forumu</title>
<link href="https://fonts.googleapis.com/css2?family=Creepster&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">



<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Cinzel', serif;
background: linear-gradient(135deg, #0a0a0a 0%, #1a0a1f 100%);
color: #e0e0e0;
min-height: 100vh;
overflow-x: hidden;
position: relative;
}

body::before {
content: '';
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: repeating-linear-gradient(
0deg,
rgba(255, 0, 0, 0.03) 0px,
rgba(255, 0, 0, 0.03) 1px,
transparent 1px,
transparent 2px
);
pointer-events: none;
z-index: 1;
}

.container {
position: relative;
z-index: 2;
}

/* Navbar */
nav {
background: rgba(10, 10, 10, 0.95);
border-bottom: 2px solid #8b0000;
padding: 1rem 2rem;
display: flex;
justify-content: space-between;
align-items: center;
box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3);
backdrop-filter: blur(10px);
}

.logo {
font-family: 'Creepster', cursive;
font-size: 1.8rem;
color: #ff4444;
text-shadow: 0 0 10px #ff0000, 0 0 20px #8b0000;
cursor: pointer;
transition: all 0.3s ease;
}

.logo:hover {
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
transform: scale(1.05);
}

.nav-menu {
display: flex;
gap: 2rem;
list-style: none;
flex-grow: 1;
justify-content: center;
}

.nav-menu a {
color: #e0e0e0;
text-decoration: none;
padding: 0.5rem 1rem;
border-radius: 5px;
transition: all 0.3s ease;
position: relative;
}

.nav-menu a::before {
content: '';
position: absolute;
bottom: -2px;
left: 0;
width: 0;
height: 2px;
background: #ff4444;
transition: width 0.3s ease;
}

.nav-menu a:hover {
background: rgba(255, 64, 64, 0.2);
}

.nav-menu a:hover::before {
width: 100%;
}

.nav-right {
display: flex;
gap: 1rem;
align-items: center;
}

.user-info {
color: #ff4444;
font-weight: bold;
}

.btn {
padding: 0.7rem 1.5rem;
border: none;
background: linear-gradient(135deg, #8b0000, #ff0000);
color: white;
border-radius: 8px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
font-weight: bold;
}

.btn::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: rgba(255, 255, 255, 0.2);
transition: left 0.3s ease;
}

.btn:hover {
box-shadow: 0 0 20px rgba(255, 0, 0, 0.8), inset 0 0 10px rgba(255, 0, 0, 0.4);
transform: translateY(-2px);
}

.btn:hover::before {
left: 100%;
}

.btn-secondary {
background: rgba(100, 100, 100, 0.8);
border: 1px solid #666;
}

.btn-secondary:hover {
box-shadow: 0 0 15px rgba(150, 150, 150, 0.6);
background: rgba(120, 120, 120, 0.9);
}

/* Modal ve Sayfalar */
.page {
display: none;
animation: fadeIn 0.5s ease;
}

.page.active {
display: block;
}

@keyframes fadeIn {
from {
opacity: 0;
transform: translateY(10px);
}
to {
opacity: 1;
transform: translateY(0);
}
}

.modal {
display: none;
position: fixed;
z-index: 1000;
left: 0;
top: 0;
width: 100%;
height: 100%;
background-color: rgba(0, 0, 0, 0.7);
backdrop-filter: blur(5px);
animation: fadeIn 0.3s ease;
}

.modal.show {
display: flex;
justify-content: center;
align-items: center;
}

.modal-content {
background: linear-gradient(135deg, #1a1a1a, #2d1b3d);
border: 2px solid #8b0000;
border-radius: 15px;
padding: 2rem;
max-width: 500px;
width: 90%;
box-shadow: 0 0 30px rgba(139, 0, 0, 0.5);
animation: slideUp 0.3s ease;
}

@keyframes slideUp {
from {
transform: translateY(50px);
opacity: 0;
}
to {
transform: translateY(0);
opacity: 1;
}
}

.close-btn {
color: #ff4444;
float: right;
font-size: 1.5rem;
font-weight: bold;
cursor: pointer;
transition: all 0.3s ease;
}

.close-btn:hover {
color: #ff0000;
transform: scale(1.2);
}

/* Form Styles */
.form-group {
margin-bottom: 1.5rem;
}

label {
display: block;
margin-bottom: 0.5rem;
color: #ff9999;
font-weight: bold;
}

input, textarea, select {
width: 100%;
padding: 0.8rem;
border: 1px solid #8b0000;
background: rgba(40, 20, 40, 0.8);
color: #e0e0e0;
border-radius: 8px;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
}

input:focus, textarea:focus, select:focus {
outline: none;
border-color: #ff4444;
box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
background: rgba(60, 30, 60, 0.9);
}

/* Ana Sayfa */
.hero {
text-align: center;
padding: 3rem 2rem;
margin: 2rem 0;
background-color: #2d1b3d;
}

.hero h1 {
font-family: 'Creepster', cursive;
font-size: 3.5rem;
color: #ff4444;
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
margin-bottom: 1rem;
animation: glow 2s ease-in-out infinite;
}

@keyframes glow {
0%, 100% {
text-shadow: 0 0 20px #ff0000, 0 0 40px #8b0000;
}
50% {
text-shadow: 0 0 30px #ff0000, 0 0 60px #8b0000;
}
}

.hero p {
color: #b0b0b0;
font-size: 1.1rem;
margin-bottom: 2rem;
}

/* Filtreleme */
.filter-section {
background: rgba(20, 10, 20, 0.8);
padding: 2rem;
margin: 2rem 2rem;
border-radius: 10px;
border: 1px solid #8b0000;
box-shadow: 0 4px 15px rgba(139, 0, 0, 0.2);
}

.filter-row {
display: flex;
gap: 1rem;
flex-wrap: wrap;
margin-bottom: 1rem;
}

.filter-row select, .filter-row input {
flex: 1;
min-width: 150px;
}

/* Hikaye Kartlarƒ± */
.stories-section {
padding: 2rem;
display: grid;
grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
gap: 2rem;
max-width: 1400px;
margin: 0 auto;
}

.story-card {
background: linear-gradient(135deg, rgba(30, 10, 30, 0.9), rgba(50, 20, 50, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
padding: 1.5rem;
cursor: pointer;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
}

.story-card::before {
content: '';
position: absolute;
top: 0;
left: -100%;
width: 100%;
height: 100%;
background: linear-gradient(90deg, transparent, rgba(255, 0, 0, 0.1));
transition: left 0.5s ease;
}

.story-card:hover {
border-color: #ff4444;
box-shadow: 0 0 30px rgba(255, 0, 0, 0.5), inset 0 0 20px rgba(255, 0, 0, 0.1);
transform: translateY(-5px);
}

.story-card:hover::before {
left: 100%;
}

.story-title {
font-size: 1.3rem;
color: #ff9999;
margin-bottom: 0.5rem;
font-weight: bold;
}

.story-preview {
color: #b0b0b0;
font-size: 0.95rem;
margin-bottom: 1rem;
line-height: 1.5;
max-height: 100px;
overflow: hidden;
text-overflow: ellipsis;
}

.story-meta {
display: flex;
justify-content: space-between;
align-items: center;
font-size: 0.85rem;
color: #888;
margin-bottom: 1rem;
flex-wrap: wrap;
gap: 0.5rem;
}

.story-author {
color: #ff6666;
font-weight: bold;
}

.story-actions {
display: flex;
gap: 1rem;
margin-top: 1rem;
}

.action-btn {
flex: 1;
padding: 0.6rem;
background: rgba(139, 0, 0, 0.4);
border: 1px solid #8b0000;
color: #ff9999;
border-radius: 6px;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
gap: 0.5rem;
font-family: 'Cinzel', serif;
font-size: 0.9rem;
}

.action-btn:hover {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
box-shadow: 0 0 10px rgba(255, 0, 0, 0.4);
}

.action-btn.liked {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

        .action-btn.saved {
            background: rgba(255, 200, 0, 0.3);
            color: #ffcc00;
        }

/* Hikaye Detay */
.story-detail {
max-width: 900px;
margin: 2rem auto;
padding: 2rem;
background: linear-gradient(135deg, rgba(20, 10, 20, 0.9), rgba(40, 20, 40, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
box-shadow: 0 4px 20px rgba(139, 0, 0, 0.3);
}

.detail-header {
border-bottom: 2px solid #8b0000;
padding-bottom: 2rem;
margin-bottom: 2rem;
}

.detail-title {
font-size: 2rem;
color: #ff9999;
margin-bottom: 1rem;
font-weight: bold;
}

.detail-meta {
display: flex;
gap: 2rem;
color: #888;
font-size: 0.95rem;
flex-wrap: wrap;
}

.detail-meta span {
display: flex;
gap: 0.5rem;
align-items: center;
}

.detail-content {
color: #d0d0d0;
line-height: 1.8;
margin: 2rem 0;
font-size: 1.05rem;
white-space: pre-wrap;
word-break: break-word;
}

.detail-actions {
display: flex;
gap: 1rem;
margin: 2rem 0;
flex-wrap: wrap;
}

/* Yorum Sistemi */
.comments-section {
margin-top: 3rem;
border-top: 2px solid #8b0000;
padding-top: 2rem;
}

.comments-title {
font-size: 1.5rem;
color: #ff9999;
margin-bottom: 1.5rem;
font-weight: bold;
}

.comment-form {
background: rgba(40, 20, 40, 0.8);
padding: 1.5rem;
border-radius: 10px;
border: 1px solid #663366;
margin-bottom: 2rem;
}

.comment-list {
display: flex;
flex-direction: column;
gap: 1.5rem;
}

.comment-card {
background: rgba(30, 15, 30, 0.8);
padding: 1.5rem;
border-left: 3px solid #8b0000;
border-radius: 8px;
transition: all 0.3s ease;
}

.comment-card:hover {
box-shadow: 0 0 15px rgba(255, 0, 0, 0.2);
border-left-color: #ff4444;
}

.comment-header {
display: flex;
justify-content: space-between;
margin-bottom: 0.8rem;
flex-wrap: wrap;
gap: 1rem;
}

.comment-author {
color: #ff9999;
font-weight: bold;
}

.comment-date {
color: #888;
font-size: 0.85rem;
}

.comment-text {
color: #d0d0d0;
margin-bottom: 1rem;
line-height: 1.6;
white-space: pre-wrap;
word-break: break-word;
}

.comment-actions {
display: flex;
gap: 1rem;
}

.comment-like {
background: rgba(139, 0, 0, 0.3);
border: none;
color: #ff9999;
padding: 0.5rem 1rem;
border-radius: 6px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
display: flex;
align-items: center;
gap: 0.5rem;
}

.comment-like:hover {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

.comment-like.liked {
background: rgba(255, 0, 0, 0.3);
color: #ff4444;
}

/* Kullanƒ±cƒ± Profili */
.profile-section {
max-width: 1000px;
margin: 2rem auto;
padding: 2rem;
}

.profile-header {
background: linear-gradient(135deg, rgba(30, 10, 50, 0.9), rgba(50, 20, 70, 0.9));
border: 1px solid #8b0000;
border-radius: 12px;
padding: 2rem;
text-align: center;
margin-bottom: 2rem;
box-shadow: 0 4px 20px rgba(139, 0, 0, 0.3);
}

.profile-avatar {
width: 120px;
height: 120px;
margin: 0 auto 1rem;
background: linear-gradient(135deg, #8b0000, #ff0000);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
font-size: 3rem;
color: #fff;
border: 3px solid #ff4444;
box-shadow: 0 0 20px rgba(255, 0, 0, 0.4);
}

.profile-name {
font-size: 1.8rem;
color: #ff9999;
margin-bottom: 0.5rem;
font-weight: bold;
}

.profile-stats {
display: flex;
justify-content: space-around;
margin-top: 1.5rem;
font-size: 0.9rem;
color: #888;
flex-wrap: wrap;
gap: 1rem;
}

.profile-stat {
text-align: center;
}

.profile-stat-number {
font-size: 1.5rem;
color: #ff9999;
font-weight: bold;
}

/* ƒ∞leti≈üim Bilgileri */
.profile-contact {
display: flex;
justify-content: center;
gap: 2rem;
margin-top: 1.5rem;
flex-wrap: wrap;
}

.contact-item {
display: flex;
align-items: center;
gap: 0.5rem;
color: #b0b0b0;
font-size: 0.95rem;
transition: all 0.3s ease;
}

.contact-item a {
color: #66ccff;
text-decoration: none;
font-weight: bold;
transition: all 0.3s ease;
}

.contact-item a:hover {
color: #ff9999;
text-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
}

.contact-item i {
color: #ff9999;
font-size: 1.2rem;
}

.profile-tabs {
display: flex;
gap: 1rem;
margin-bottom: 2rem;
border-bottom: 2px solid #8b0000;
}

.profile-tab {
padding: 1rem 2rem;
background: transparent;
border: none;
color: #888;
cursor: pointer;
font-family: 'Cinzel', serif;
font-weight: bold;
transition: all 0.3s ease;
position: relative;
}

.profile-tab.active {
color: #ff9999;
}

.profile-tab.active::after {
content: '';
position: absolute;
bottom: -2px;
left: 0;
right: 0;
height: 2px;
background: #ff4444;
}

.profile-content {
display: none;
}

.profile-content.active {
display: block;
}

/* Bo≈ü Durum */
.empty-state {
text-align: center;
padding: 3rem 2rem;
color: #888;
}

.empty-state-icon {
font-size: 3rem;
margin-bottom: 1rem;
color: #8b0000;
}

/* Arama Sonu√ßlarƒ± */
.search-stats {
background: rgba(100, 50, 100, 0.3);
border: 1px solid #8b0000;
padding: 1.5rem;
border-radius: 8px;
margin-bottom: 1.5rem;
display: None;
flex-direction: column;
gap: 1rem;
}

.search-stats.show {
display: flex;
}

.search-stats-header {
display: flex;
justify-content: space-between;
align-items: center;
flex-wrap: wrap;
gap: 1rem;
}

.search-term {
color: #ff9999;
font-weight: bold;
font-size: 1.1rem;
}

.search-count {
background: rgba(139, 0, 0, 0.5);
padding: 0.5rem 1rem;
border-radius: 6px;
color: #ff9999;
font-weight: bold;
}

.search-filters-info {
color: #b0b0b0;
font-size: 0.95rem;
}

.search-filters-info span {
display: inline-block;
margin-right: 1.5rem;
color: #d0d0d0;
}

.clear-search-btn {
padding: 0.5rem 1rem;
background: rgba(100, 50, 50, 0.6);
border: 1px solid #8b0000;
color: #ff9999;
border-radius: 6px;
cursor: pointer;
font-family: 'Cinzel', serif;
transition: all 0.3s ease;
}

.clear-search-btn:hover {
background: rgba(139, 0, 0, 0.5);
box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
}

.search-input-wrapper {
position: relative;
flex: 1;
min-width: 200px;
}

.search-clear-btn {
position: absolute;
right: 10px;
top: 50%;
transform: translateY(-50%);
background: none;
border: none;
color: #ff9999;
cursor: pointer;
font-size: 1.2rem;
transition: all 0.3s ease;
display: none;
}

.search-clear-btn:hover {
color: #ff4444;
transform: translateY(-50%) scale(1.2);
}

.search-input-wrapper.has-text .search-clear-btn {
display: block;
}

/* Ba≈üarƒ± Mesajƒ± */
.toast {
position: fixed;
bottom: 20px;
right: 20px;
background: rgba(0, 100, 0, 0.9);
color: #90EE90;
padding: 1rem 1.5rem;
border-radius: 8px;
border-left: 4px solid #00FF00;
animation: slideInUp 0.3s ease;
z-index: 2000;
}

/* Footer */
footer {
background: rgba(10, 10, 10, 0.95);
border-top: 2px solid #8b0000;
padding: 2rem;
margin-top: 3rem;
text-align: center;
box-shadow: 0 -4px 15px rgba(139, 0, 0, 0.3);
}

.footer-content {
max-width: 1200px;
margin: 0 auto;
}

.footer-title {
font-family: 'Creepster', cursive;
font-size: 1.5rem;
color: #ff9999;
margin-bottom: 1rem;
text-shadow: 0 0 10px #ff0000;
}

.footer-social {
display: flex;
justify-content: center;
gap: 2rem;
margin-bottom: 1.5rem;
flex-wrap: wrap;
}

.social-link {
display: flex;
align-items: center;
gap: 0.5rem;
color: #b0b0b0;
text-decoration: none;
transition: all 0.3s ease;
padding: 0.8rem 1.5rem;
border: 1px solid #8b0000;
border-radius: 8px;
font-weight: bold;
}

.social-link i {
color: #ff9999;
font-size: 1.2rem;
}

.social-link:hover {
color: #ff9999;
border-color: #ff4444;
background: rgba(139, 0, 0, 0.2);
box-shadow: 0 0 15px rgba(255, 0, 0, 0.2);
transform: translateY(-2px);
}

.footer-text {
color: #888;
font-size: 0.9rem;
border-top: 1px solid #333;
padding-top: 1.5rem;
animation: slideInUp 0.3s ease;
z-index: 2000;
}

@keyframes slideInUp {
from {
transform: translateY(100px);
opacity: 0;
}
to {
transform: translateY(0);
opacity: 1;
}
}

/* Responsive */
@media (max-width: 768px) {
nav {
                flex-direction: column;
                gap: 1rem;
                flex-direction: row;
                gap: 0.5rem;
                padding: 0.8rem 1rem;
                justify-content: space-between;
                align-items: center;
            }

            .logo {
                font-size: 1.2rem;
                order: 1;
}

.nav-menu {
                gap: 1rem;
                font-size: 0.9rem;
                order: 3;
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                flex-direction: column;
                gap: 0;
                background: rgba(10, 10, 10, 0.95);
                border-top: 2px solid #8b0000;
                padding: 1rem;
                display: none;
                margin: 0;
            }

            .nav-menu.mobile-open {
                display: flex;
            }

            .nav-menu a {
                padding: 0.8rem;
                border-bottom: 1px solid #333;
            }

            #hamburgerBtn {
                order: 2;
                display: block !important;
}

.hero h1 {
font-size: 2.5rem;
}

.stories-section {
grid-template-columns: 1fr;
}

.filter-row {
flex-direction: column;
}

.filter-row select, .filter-row input {
min-width: auto;
}

.profile-tabs {
flex-wrap: wrap;
}

.profile-tab {
padding: 0.8rem 1rem;
}
}
</style>
</head>
<body>
<!-- Navbar -->
<nav>
<div class="logo" onclick="showPage('home')">
<i class="fas fa-ghost"></i> Korku Forumu
</div>
    
        <ul class="nav-menu" id="mainMenu">
            <li><a href="#" onclick="showPage('home'); resetFilters(); toggleMobileMenu(); return false;">Ana Sayfa</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'newest'; filterStories(); toggleMobileMenu(); return false;">En Yeni</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'popular'; filterStories(); toggleMobileMenu(); return false;">En Pop√ºler</a></li>
            <li><a href="#" onclick="document.getElementById('sortFilter').value = 'mostCommented'; filterStories(); toggleMobileMenu(); return false;">En √áok Yorum</a></li>
</ul>
        <button class="btn btn-secondary" id="hamburgerBtn" style="display: none; order: 2;" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
<div class="nav-right">
<div id="userDisplay" class="user-info"></div>
<button class="btn" onclick="toggleAuth()" id="authBtn">Giri≈ü Yap</button>
<button class="btn" id="profileBtn" style="display: none;" onclick="showUserProfile()">
<i class="fas fa-user"></i> Profil
</button>
<button class="btn btn-secondary" id="logoutBtn" style="display: none;" onclick="logout()">√áƒ±kƒ±≈ü</button>
</div>
</nav>

<!-- Ana Sayfa -->
<div id="home" class="page active">
<div class="hero">

<h1> Korku Hikayeleri Forumu </h1>
<p>Karanlƒ±k ve gerilim dolu hikayelerin bulu≈ütuƒüu yer...</p>
</div>

<div class="filter-section">
<div class="filter-row">
<div class="search-input-wrapper">
<input type="text" id="searchInput" placeholder="Hikaye, yazar adƒ± veya i√ßerik ara..." onkeyup="handleSearchInput()" onchange="filterStories()">
<button class="search-clear-btn" onclick="clearSearch()" title="Temizle">
<i class="fas fa-times"></i>
</button>
</div>
<select id="searchTypeFilter" onchange="filterStories()">
<option value="all">T√ºm Alanlarda</option>
<option value="title">Sadece Ba≈ülƒ±k</option>
<option value="author">Sadece Yazar</option>
<option value="content">Sadece ƒ∞√ßerik</option>
</select>
<select id="categoryFilter" onchange="filterStories()">
<option value="">T√ºm Kategoriler</option>
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
<select id="sortFilter" onchange="filterStories()">
<option value="newest">En Yeni</option>
<option value="popular">En Pop√ºler</option>
<option value="mostCommented">En √áok Yorum</option>
<option value="likes">En √áok Beƒüeni</option>
</select>
</div>

<div class="search-stats" id="searchStats">
<div class="search-stats-header">
<span class="search-term" id="searchTermDisplay"></span>
<span class="search-count" id="resultCount"></span>
<button class="clear-search-btn" onclick="resetFilters()">
<i class="fas fa-refresh"></i> Filtreleri Sƒ±fƒ±rla
</button>
</div>
<div class="search-filters-info" id="filtersInfo"></div>
</div>

<button class="btn" id="addStoryBtn" style="display: none;" onclick="showAddStoryModal()">
<i class="fas fa-plus"></i> Hikaye Ekle
</button>
            <button class="btn btn-secondary" id="libraryBtn" style="display: none;" onclick="showPage('library')">
                <i class="fas fa-bookmark"></i> K√ºt√ºphanem
            </button>
            <button class="btn btn-secondary" id="chatBtn" style="display: none;" onclick="showPage('chat')">
                <i class="fas fa-comments"></i> Sohbet
            </button>
<div style="margin-top: 1rem; text-align: center; color: #888;">
<p id="loginPrompt">Hikaye eklemek i√ßin <a href="#" onclick="toggleAuth(); return false;" style="color: #ff9999; text-decoration: underline;">giri≈ü yapƒ±n</a></p>
</div>
</div>

<div class="stories-section" id="storiesContainer">
<!-- Hikayeler buraya y√ºklenir -->
</div>
</div>

<!-- Hikaye Detay -->
<div id="storyDetail" class="page">
<div class="story-detail">
<button class="btn btn-secondary" onclick="showPage('home')" style="margin-bottom: 2rem;">
<i class="fas fa-arrow-left"></i> Geri D√∂n
</button>
<div class="detail-header">
<h1 class="detail-title" id="detailTitle"></h1>
<div class="detail-meta">
<span><i class="fas fa-user"></i> <span id="detailAuthor"></span></span>
<span><i class="fas fa-calendar"></i> <span id="detailDate"></span></span>
<span><i class="fas fa-tag"></i> <span id="detailCategory"></span></span>
</div>
</div>
<div class="detail-content" id="detailContent"></div>
<div class="detail-actions">
<button class="action-btn" id="likeBtn" onclick="toggleLikeStory()">
<i class="fas fa-heart"></i> <span id="likeCount">0</span> Beƒüeni
</button>
<button class="action-btn" id="commentCountBtn">
<i class="fas fa-comments"></i> <span id="commentCount">0</span> Yorum
</button>
</div>

<!-- Yorum Sistemi -->
<div class="comments-section" id="commentsSection">
<h2 class="comments-title">Yorumlar</h2>

<div class="comment-form" id="commentFormContainer" style="display: none;">
<div class="form-group">
<label>Adƒ±nƒ±z</label>
<input type="text" id="commentName" readonly>
</div>
<div class="form-group">
<label>Yorumunuz</label>
<textarea id="commentText" rows="4" placeholder="D√º≈ü√ºncelerinizi payla≈üƒ±n..."></textarea>
</div>
<button class="btn" onclick="addComment()">
<i class="fas fa-paper-plane"></i> Yorum G√∂nder
</button>
</div>

<div id="commentContainer">
<!-- Yorumlar buraya y√ºklenir -->
</div>
</div>
</div>
</div>

    <!-- K√ºt√ºphane Sayfasƒ± -->
    <div id="library" class="page">
        <div style="text-align: center; padding: 2rem;">
            <h1 style="color: #ff9999; font-size: 2.5rem;"><i class="fas fa-bookmark"></i> Beƒüenilen Hikayeler</h1>
        </div>
        <div id="libraryContainer" style="max-width: 1200px; margin: 2rem auto; padding: 2rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 2rem;">
            <!-- Beƒüenilen hikayeler buraya y√ºklenir -->
        </div>
    </div>

    <!-- Chat Sayfasƒ± -->
    <div id="chat" class="page">
        <div style="text-align: center; padding: 2rem;">
            <h1 style="color: #ff9999; font-size: 2.5rem;"><i class="fas fa-comments"></i> Genel Sohbet</h1>
        </div>
        <div style="max-width: 900px; margin: 2rem auto; padding: 2rem; background: linear-gradient(135deg, rgba(20, 10, 20, 0.9), rgba(40, 20, 40, 0.9)); border: 1px solid #8b0000; border-radius: 12px; display: flex; flex-direction: column; height: 600px;">
            <div id="chatMessages" style="flex: 1; overflow-y: auto; margin-bottom: 1rem; border: 1px solid #8b0000; border-radius: 8px; padding: 1rem; background: rgba(10, 10, 10, 0.8);"></div>
            <div style="display: flex; gap: 0.5rem;">
                <input type="text" id="chatInput" placeholder="Mesajƒ±nƒ±zƒ± yazƒ±n..." style="flex: 1; padding: 0.8rem; background: rgba(50, 50, 50, 0.9); border: 1px solid #8b0000; color: #e0e0e0; border-radius: 6px;" onkeypress="handleChatKeyPress(event)">
                <button class="btn" onclick="sendChatMessage()" style="padding: 0.8rem 1.5rem;"><i class="fas fa-paper-plane"></i> G√∂nder</button>
            </div>
        </div>
    </div>

<!-- Kullanƒ±cƒ± Profili -->
<div id="userProfile" class="page">
<div class="profile-section">
<button class="btn btn-secondary" onclick="showPage('home')" style="margin-bottom: 2rem;">
<i class="fas fa-arrow-left"></i> Geri D√∂n
</button>

<div class="profile-header">
<div class="profile-avatar">üëª</div>
<div class="profile-name" id="profileUsername"></div>
<div class="profile-stats">
<div class="profile-stat">
<div class="profile-stat-number" id="profileStoriesCount">0</div>
<div>Payla≈üƒ±lan Hikaye</div>
</div>
<div class="profile-stat">
<div class="profile-stat-number" id="profileCommentsCount">0</div>
<div>Yorum Yapƒ±lan</div>
</div>
<div class="profile-stat">
<div class="profile-stat-number" id="profileLikesCount">0</div>
<div>Alƒ±nan Beƒüeni</div>
</div>
</div>
</div>

<div class="profile-tabs">
<button class="profile-tab active" onclick="switchProfileTab('stories')">
<i class="fas fa-book"></i> Hikayeler
</button>
<button class="profile-tab" onclick="switchProfileTab('comments')">
<i class="fas fa-comments"></i> Yorumlar
</button>
</div>

<div id="storiesTab" class="profile-content active">
<!-- Kullanƒ±cƒ± hikayeler -->
</div>

<div id="commentsTab" class="profile-content">
<!-- Kullanƒ±cƒ± yorumlar -->
</div>
</div>
</div>

<!-- Giri≈ü/Kayƒ±t Modal -->
<div id="authModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="toggleAuth()">&times;</span>

<div id="loginForm">
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-sign-in-alt"></i> Giri≈ü Yap
</h2>
<div class="form-group">
<label for="loginUsername">Kullanƒ±cƒ± Adƒ±</label>
<input type="text" id="loginUsername" placeholder="Kullanƒ±cƒ± adƒ±nƒ±z">
</div>
<div class="form-group">
<label for="loginEmail">E-Posta</label>
<input type="text" id="loginEmail" placeholder="E-posta adresiniz">
</div>
<div class="form-group">
<label for="loginPassword">≈ûifre</label>
<input type="password" id="loginPassword" placeholder="≈ûifreniz">
</div>
<button class="btn" style="width: 100%; margin-bottom: 1rem;" onclick="login()">
<i class="fas fa-check"></i> Giri≈ü Yap
</button>
<p style="text-align: center; color: #888;">
Hesabƒ±n yok mu? 
<a href="#" onclick="switchAuthForm(); return false;" style="color: #ff9999;">Kayƒ±t ol</a>
</p>
</div>

<div id="registerForm" style="display: none;">
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-user-plus"></i> Kayƒ±t Ol
</h2>
<div class="form-group">
<label for="registerEmail">E-posta</label>
<input type="email" id="registerEmail" placeholder="E-posta adresiniz">
</div>
<div class="form-group">
<label for="registerPassword">≈ûifre</label>
<input type="password" id="registerPassword" placeholder="En az 6 karakter">
</div>
<button class="btn" style="width: 100%; margin-bottom: 1rem;" onclick="register()">
<i class="fas fa-user-plus"></i> Kayƒ±t Ol
</button>
<p style="text-align: center; color: #888;">
Zaten hesabƒ±n var mƒ±? 
<a href="#" onclick="switchAuthForm(); return false;" style="color: #ff9999;">Giri≈ü yap</a>
</p>
</div>
</div>
</div>

<!-- Hikaye Ekleme Modal -->
<div id="addStoryModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="closeAddStoryModal()">&times;</span>
<h2 style="color: #ff9999; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-pen-fancy"></i> Yeni Hikaye Ekle
</h2>
<div class="form-group">
<label for="storyTitle">Hikaye Ba≈ülƒ±ƒüƒ±</label>
<input type="text" id="storyTitle" placeholder="Hikayenizin ba≈ülƒ±ƒüƒ±">
</div>
<div class="form-group">
<label for="storyCategory">Kategori</label>
<select id="storyCategory">
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
</div>
<div class="form-group">
<label for="storyContent">Hikaye ƒ∞√ßeriƒüi</label>
<textarea id="storyContent" rows="6" placeholder="Hikayenizi buraya yazƒ±nƒ±z..."></textarea>
</div>
<button class="btn" style="width: 100%;" onclick="addStory()">
<i class="fas fa-upload"></i> Hikayeyi Payla≈ü
</button>
</div>
</div>

<!-- Hikaye D√ºzenleme Modal -->
<div id="editStoryModal" class="modal">
<div class="modal-content">
<span class="close-btn" onclick="app.closeEditStoryModal()">&times;</span>
<h2 style="color: #66ccff; text-align: center; margin-bottom: 1.5rem;">
<i class="fas fa-edit"></i> Hikaye D√ºzenle
</h2>
<div class="form-group">
<label for="editStoryTitle">Hikaye Ba≈ülƒ±ƒüƒ±</label>
<input type="text" id="editStoryTitle" placeholder="Hikayenizin ba≈ülƒ±ƒüƒ±">
</div>
<div class="form-group">
<label for="editStoryCategory">Kategori</label>
<select id="editStoryCategory">
<option value="Kƒ±sa Hikaye">Kƒ±sa Hikaye</option>
<option value="Uzun Hikaye">Uzun Hikaye</option>
<option value="√úrk√ºt√ºc√º">√úrk√ºt√ºc√º</option>
<option value="Gizemli">Gizemli</option>
<option value="Psikiyatrik">Psikiyatrik</option>
</select>
</div>
<div class="form-group">
<label for="editStoryContent">Hikaye ƒ∞√ßeriƒüi</label>
<textarea id="editStoryContent" rows="6" placeholder="Hikayenizi buraya yazƒ±nƒ±z..."></textarea>
</div>
<div style="display: flex; gap: 1rem;">
<button class="btn" style="flex: 1;" onclick="app.saveEditStory()">
<i class="fas fa-save"></i> Kaydet
</button>
<button class="btn btn-secondary" style="flex: 1;" onclick="app.closeEditStoryModal()">
<i class="fas fa-times"></i> ƒ∞ptal
</button>
</div>
</div>
</div>

<script>
// ===== VERƒ∞ Y√ñNETƒ∞Mƒ∞ =====
class ForumApp {
constructor() {
this.users = JSON.parse(localStorage.getItem('users')) || [];

                // ƒ∞lk kez ise admin hesabƒ± ekle
                // ƒ∞lk kez ise admin ve demo hesabƒ± ekle
if (this.users.length === 0) {
this.users.push({ 
username: 'admin', 
email: 'admin@forum.com', 
                        password: 'sshs693434',
                        password: 'admin123',
instagram: 'emirslmn_',
github: 'ermirhansalman4'
});
                    this.users.push({ 
                        username: 'demo', 
                        email: 'demo@test.com', 
                        password: 'demo123'
                    });
}

// currentUser yoksa null - giri≈ü yapmasƒ± gerek
this.currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

this.allStories = JSON.parse(localStorage.getItem('stories')) || this.getInitialStories();
this.stories = this.allStories.slice(); // A√ßƒ±k√ßa kopyala
this.comments = JSON.parse(localStorage.getItem('comments')) || [];
this.currentStoryId = null;
this.searchActive = false;
this.editingStoryId = null;
                this.chatMessages = JSON.parse(localStorage.getItem('chatMessages')) || [];
                this.savedStoryIds = JSON.parse(localStorage.getItem('savedStoryIds')) || [];
this.init();
}

getInitialStories() {
return [
{
id: 1,
title: "Eski Evin Sƒ±rrƒ±",
content: "Yeni ta≈üƒ±ndƒ±ƒüƒ±m evin bodrum katƒ±nda bir oda buldum. Kapƒ±sƒ± kilitliydi. Her gece oradan garip sesler geliyordu. Merakla kilit a√ßmaya √ßalƒ±≈ütƒ±m. Kapƒ± a√ßƒ±ldƒ± ve i√ßeride... (Devamƒ±nƒ± g√∂rmek i√ßin tƒ±klayƒ±n)",
author: "Admin",
category: "Gizemli",
date: new Date(Date.now() - 86400000 * 2).toLocaleString('tr-TR'),
likes: 15,
liked: false
},
{
id: 2,
title: "√ñdenmeyen Bor√ß",
content: "Bir gece, kapƒ±ma tuhaf bir mektup i√ßeri ge√ßti. 'Borcunuz √∂denmeyecek. Bedeli √ßok aƒüƒ±r olacak' yazƒ±yordu. Ne borcum vardƒ± ne bilemiyordum fakat bitti. Ertesi g√ºn, benimle aynƒ± adƒ± ta≈üƒ±yan √∂l√º bulundu.\n\nMektup devam ediyordu...",
author: "Admin",
category: "√úrk√ºt√ºc√º",
date: new Date(Date.now() - 86400000).toLocaleString('tr-TR'),
likes: 8,
liked: false
},
{
id: 3,
title: "Aynada G√∂rd√ºƒü√ºm ≈ûey",
content: "Sabah aynaya baktƒ±ƒüƒ±mda y√ºz√ºm√º tanƒ±madƒ±m. Tam benim gibi, ama g√∂zleri farklƒ±ydƒ±. √áok eski g√∂r√ºn√ºyordu. Elleriyle bana dokunmaya √ßalƒ±≈ütƒ±... Ve ben geriye adƒ±m attƒ±ƒüƒ±mda ayna patladƒ±.",
author: "Admin",
category: "Kƒ±sa Hikaye",
date: new Date(Date.now() - 86400000 * 3).toLocaleString('tr-TR'),
likes: 22,
liked: false
}
];
}

init() {
this.updateUI();
this.renderStories();
}

updateUI() {
const userDisplay = document.getElementById('userDisplay');
const authBtn = document.getElementById('authBtn');
const profileBtn = document.getElementById('profileBtn');
const logoutBtn = document.getElementById('logoutBtn');
const addStoryBtn = document.getElementById('addStoryBtn');
                const libraryBtn = document.getElementById('libraryBtn');
                const chatBtn = document.getElementById('chatBtn');
const loginPrompt = document.getElementById('loginPrompt');

if (this.currentUser) {
userDisplay.textContent = `üëª ${this.currentUser.username}`;
authBtn.style.display = 'none';
profileBtn.style.display = 'block';
logoutBtn.style.display = 'block';
addStoryBtn.style.display = 'block';
                    libraryBtn.style.display = 'block';
                    chatBtn.style.display = 'block';
loginPrompt.style.display = 'none';
} else {
userDisplay.textContent = '';
authBtn.style.display = 'block';
profileBtn.style.display = 'none';
logoutBtn.style.display = 'none';
addStoryBtn.style.display = 'none';
                    libraryBtn.style.display = 'none';
                    chatBtn.style.display = 'none';
loginPrompt.style.display = 'block';
}
}

save() {
localStorage.setItem('users', JSON.stringify(this.users));
localStorage.setItem('stories', JSON.stringify(this.allStories));
localStorage.setItem('comments', JSON.stringify(this.comments));
localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
                localStorage.setItem('chatMessages', JSON.stringify(this.chatMessages));
                localStorage.setItem('savedStoryIds', JSON.stringify(this.savedStoryIds));
}

deleteStory(storyId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === storyId);
if (!story) return;

if (this.currentUser.username !== 'admin' && story.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi hikayelerinizi silebilirsiniz!');
return;
}

if (confirm(`"${story.title}" hikayesini silmek istediƒüinize emin misiniz?`)) {
this.allStories = this.allStories.filter(s => s.id !== storyId);
this.stories = this.stories.filter(s => s.id !== storyId);
this.comments = this.comments.filter(c => c.storyId !== storyId);
this.save();
this.renderStories();
showToast('Hikaye silindi!');
}
}

editStory(storyId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === storyId);
if (!story) return;

if (this.currentUser.username !== 'admin' && story.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi hikayelerinizi d√ºzenleyebilirsiniz!');
return;
}

this.editingStoryId = storyId;
document.getElementById('editStoryTitle').value = story.title;
document.getElementById('editStoryCategory').value = story.category;
document.getElementById('editStoryContent').value = story.content;
document.getElementById('editStoryModal').classList.add('show');
}

saveEditStory() {
if (!this.editingStoryId) return;

const title = document.getElementById('editStoryTitle').value.trim();
const category = document.getElementById('editStoryCategory').value;
const content = document.getElementById('editStoryContent').value.trim();

if (!title || !content) {
showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
return;
}

const story = this.allStories.find(s => s.id === this.editingStoryId);
if (story) {
story.title = title;
story.category = category;
story.content = content;
this.save();
this.stories = this.allStories.slice();
this.renderStories();
this.closeEditStoryModal();
showToast('Hikaye g√ºncellendi!');
}
}

closeEditStoryModal() {
document.getElementById('editStoryModal').classList.remove('show');
this.editingStoryId = null;
}

renderStories() {
const container = document.getElementById('storiesContainer');
container.innerHTML = '';

if (this.stories.length === 0) {
container.innerHTML = `
                       <div style="grid-column: 1/-1;">
                           <div class="empty-state">
                               <div class="empty-state-icon">üìñ</div>
                               <h3>Hi√ß Hikaye Yok</h3>
                               <p>ƒ∞lk hikayeyi sen payla≈ü ve forumu ba≈ülat!</p>
                           </div>
                       </div>
                   `;
return;
}

this.stories.forEach(story => {
const commentCount = this.comments.filter(c => c.storyId === story.id).length;
const card = document.createElement('div');
card.className = 'story-card';
const isAdmin = this.currentUser && (this.currentUser.username === 'admin' || story.author === this.currentUser.username);
let adminButtons = '';

if (isAdmin) {
adminButtons = `
                           <button class="action-btn" style="background: rgba(100, 150, 255, 0.3); color: #66ccff;" onclick="app.editStory(${story.id})" title="D√ºzenle">
                               <i class="fas fa-edit"></i> D√ºzenle
                           </button>
                           <button class="action-btn" style="background: rgba(255, 100, 100, 0.3); color: #ff6666;" onclick="app.deleteStory(${story.id})" title="Sil">
                               <i class="fas fa-trash"></i> Sil
                           </button>
                       `;
}

card.innerHTML = `
                       <div class="story-title">${this.escapeHtml(story.title)}</div>
                       <div class="story-preview">${this.escapeHtml(story.content.substring(0, 150))}</div>
                       <div class="story-meta">
                           <span class="story-author">${this.escapeHtml(story.author)}</span>
                           <span>${story.date}</span>
                       </div>
                       <div class="story-actions">
                           <button class="action-btn" onclick="app.viewStory(${story.id})">
                               <i class="fas fa-eye"></i> Oku (${commentCount})
                           </button>
                           <button class="action-btn ${story.liked ? 'liked' : ''}" onclick="app.toggleLike(${story.id})">
                               <i class="fas fa-heart"></i> ${story.likes}
                           </button>
                            <button class="action-btn ${this.savedStoryIds.includes(story.id) ? 'saved' : ''}" onclick="app.toggleSaveStory(${story.id})" title="Kaydet">
                                <i class="fas fa-bookmark"></i>
                            </button>
                           ${adminButtons}
                       </div>
                   `;
container.appendChild(card);
});
}

filterAndSortStories() {
const search = document.getElementById('searchInput').value.toLowerCase();
const searchType = document.getElementById('searchTypeFilter').value;
const category = document.getElementById('categoryFilter').value;
const sort = document.getElementById('sortFilter').value;

// Orijinal verjden ba≈üla
let filtered = this.allStories.slice();

// Arama filtresi
if (search) {
this.searchActive = true;
filtered = filtered.filter(story => {
const titleMatch = story.title.toLowerCase().includes(search);
const authorMatch = story.author.toLowerCase().includes(search);
const contentMatch = story.content.toLowerCase().includes(search);

if (searchType === 'title') {
return titleMatch;
} else if (searchType === 'author') {
return authorMatch;
} else if (searchType === 'content') {
return contentMatch;
} else {
// 'all' - t√ºm alanlarda
return titleMatch || authorMatch || contentMatch;
}
});
} else {
this.searchActive = false;
}

// Kategori filtresi
if (category) {
filtered = filtered.filter(story => story.category === category);
}

// Sƒ±ralama
if (sort === 'newest') {
filtered.sort((a, b) => new Date(b.date) - new Date(a.date));
} else if (sort === 'popular') {
filtered.sort((a, b) => b.likes - a.likes);
} else if (sort === 'mostCommented') {
filtered.sort((a, b) => {
const aComments = this.comments.filter(c => c.storyId === a.id).length;
const bComments = this.comments.filter(c => c.storyId === b.id).length;
return bComments - aComments;
});
} else if (sort === 'likes') {
filtered.sort((a, b) => b.likes - a.likes);
}

// Orijinal veri kesinlikle korunur
this.stories = filtered;
this.renderStories();
this.updateSearchStats();
}

updateSearchStats() {
const statsContainer = document.getElementById('searchStats');
const search = document.getElementById('searchInput').value.toLowerCase();
const category = document.getElementById('categoryFilter').value;
const searchType = document.getElementById('searchTypeFilter').value;

if (search || category || searchType !== 'all') {
statsContainer.classList.add('show');

// Arama terimi
if (search) {
document.getElementById('searchTermDisplay').innerHTML = 
`üîç <strong>"${this.escapeHtml(search)}"</strong> arandƒ±`;
} else {
document.getElementById('searchTermDisplay').innerHTML = 'üîç Filtreler uygulandƒ±';
}

// Sonu√ß sayƒ±sƒ±
const count = this.stories.length;
document.getElementById('resultCount').innerHTML = 
`<i class="fas fa-book"></i> ${count} hikaye bulundu`;

// Filtre bilgileri
let filterInfo = '';
if (search) {
const searchTypeLabel = {
'all': 'T√ºm Alanlarda',
'title': 'Ba≈ülƒ±kta',
'author': 'Yazarda',
'content': 'ƒ∞√ßerikte'
};
filterInfo += `<span><i class="fas fa-search"></i> Arama T√ºr√º: ${searchTypeLabel[searchType]}</span>`;
}
if (category) {
filterInfo += `<span><i class="fas fa-tag"></i> Kategori: ${category}</span>`;
}

const sortLabels = {
'newest': 'En Yeni',
'popular': 'En Pop√ºler',
'mostCommented': 'En √áok Yorum',
'likes': 'En √áok Beƒüeni'
};
const sortValue = document.getElementById('sortFilter').value;
filterInfo += `<span><i class="fas fa-sort"></i> Sƒ±ralama: ${sortLabels[sortValue]}</span>`;

document.getElementById('filtersInfo').innerHTML = filterInfo;
} else {
statsContainer.classList.remove('show');
}
}

toggleLike(storyId) {
const story = this.allStories.find(s => s.id === storyId);
if (story) {
story.liked = !story.liked;
story.likes += story.liked ? 1 : -1;
this.save();
this.renderStories();
}
}

addNewStory(title, category, content) {
if (!this.currentUser || !title.trim() || !content.trim()) {
showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
return false;
}

const id = Math.max(...this.allStories.map(s => s.id), 0) + 1;
const story = {
id,
title,
content,
author: this.currentUser.username,
category,
date: new Date().toLocaleString('tr-TR'),
likes: 0,
liked: false
};

this.allStories.unshift(story);
this.stories = this.allStories.slice();
this.save();
this.renderStories();
showToast('Hikaye ba≈üarƒ±yla payla≈üƒ±ldƒ±!');
return true;
}

viewStory(storyId) {
this.currentStoryId = storyId;
const story = this.allStories.find(s => s.id === storyId);

if (story) {
document.getElementById('detailTitle').textContent = story.title;
document.getElementById('detailAuthor').textContent = story.author;
document.getElementById('detailDate').textContent = story.date;
document.getElementById('detailCategory').textContent = story.category;
document.getElementById('detailContent').textContent = story.content;
document.getElementById('likeCount').textContent = story.likes;

const commentCount = this.comments.filter(c => c.storyId === storyId).length;
document.getElementById('commentCount').textContent = commentCount;

const likeBtn = document.getElementById('likeBtn');
if (story.liked) {
likeBtn.classList.add('liked');
} else {
likeBtn.classList.remove('liked');
}

// Yorum formu
const commentFormContainer = document.getElementById('commentFormContainer');
if (this.currentUser) {
commentFormContainer.style.display = 'block';
document.getElementById('commentName').value = this.currentUser.username;
} else {
commentFormContainer.style.display = 'none';
}

this.renderComments(storyId);
showPage('storyDetail');
}
}

toggleLikeStory() {
if (!this.currentUser) {
showToast('Beƒüenmek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}

const story = this.allStories.find(s => s.id === this.currentStoryId);
if (story) {
story.liked = !story.liked;
story.likes += story.liked ? 1 : -1;
document.getElementById('likeCount').textContent = story.likes;

const likeBtn = document.getElementById('likeBtn');
if (story.liked) {
likeBtn.classList.add('liked');
} else {
likeBtn.classList.remove('liked');
}

this.save();
this.renderStories();
}
}

renderComments(storyId) {
const container = document.getElementById('commentContainer');
container.innerHTML = '';

const storyComments = this.comments.filter(c => c.storyId === storyId)
.sort((a, b) => new Date(b.date) - new Date(a.date));

if (storyComments.length === 0) {
container.innerHTML = '<div class="empty-state"><p>Hen√ºz yorum yapƒ±lmamƒ±≈ü. ƒ∞lk yorumu sen yap!</p></div>';
return;
}

storyComments.forEach(comment => {
const card = document.createElement('div');
card.className = 'comment-card';
const isAdmin = this.currentUser && (this.currentUser.username === 'admin' || comment.author === this.currentUser.username);
let adminButtons = '';

if (isAdmin) {
adminButtons = `
                           <button class="comment-like" style="background: rgba(255, 100, 100, 0.3); color: #ff6666; margin-left: 0.5rem;" onclick="app.deleteComment(${comment.id})" title="Sil">
                               <i class="fas fa-trash"></i> Sil
                           </button>
                       `;
}

card.innerHTML = `
                       <div class="comment-header">
                           <span class="comment-author">${this.escapeHtml(comment.author)}</span>
                           <span class="comment-date">${comment.date}</span>
                       </div>
                       <div class="comment-text">${this.escapeHtml(comment.text)}</div>
                       <div class="comment-actions">
                           <button class="comment-like ${comment.liked ? 'liked' : ''}" onclick="app.toggleCommentLike(${comment.id})">
                               <i class="fas fa-heart"></i> ${comment.likes}
                           </button>
                           ${adminButtons}
                       </div>
                   `;
container.appendChild(card);
});
}

deleteComment(commentId) {
if (!this.currentUser) {
showToast('Giri≈ü yapƒ±nƒ±z!');
return;
}

const comment = this.comments.find(c => c.id === commentId);
if (!comment) return;

if (this.currentUser.username !== 'admin' && comment.author !== this.currentUser.username) {
showToast('Yalnƒ±zca kendi yorumlarƒ±nƒ±zƒ± silebilirsiniz!');
return;
}

if (confirm('Yorumu silmek istediƒüinize emin misiniz?')) {
this.comments = this.comments.filter(c => c.id !== commentId);
this.save();
this.renderComments(this.currentStoryId);
showToast('Yorum silindi!');
}
}

addNewComment(text) {
if (!this.currentUser) {
showToast('Yorum yapmak i√ßin giri≈ü yapƒ±nƒ±z!');
return false;
}

if (!text.trim()) {
showToast('Yorum yazƒ±nƒ±z!');
return false;
}

const id = Math.max(...this.comments.map(c => c.id), 0) + 1;
const comment = {
id,
storyId: this.currentStoryId,
author: this.currentUser.username,
text,
date: new Date().toLocaleString('tr-TR'),
likes: 0,
liked: false
};

this.comments.push(comment);
this.save();
this.renderComments(this.currentStoryId);

const commentCount = this.comments.filter(c => c.storyId === this.currentStoryId).length;
document.getElementById('commentCount').textContent = commentCount;

return true;
}

toggleCommentLike(commentId) {
if (!this.currentUser) {
showToast('Beƒüenmek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}

const comment = this.comments.find(c => c.id === commentId);
if (comment) {
comment.liked = !comment.liked;
comment.likes += comment.liked ? 1 : -1;
this.save();
this.renderComments(this.currentStoryId);
}
}

getUserProfile(username) {
const user = this.users.find(u => u.username === username);
const userStories = this.allStories.filter(s => s.author === username);
const userComments = this.comments.filter(c => c.author === username);

let userLikesCount = 0;
userStories.forEach(story => {
userLikesCount += story.likes;
});
userComments.forEach(comment => {
userLikesCount += comment.likes;
});

return {
username,
stories: userStories,
comments: userComments,
likesCount: userLikesCount,
stats: {
stories: userStories.length,
comments: userComments.length,
likes: userLikesCount
}
};
}

renderUserProfile(username) {
const profile = this.getUserProfile(username);

document.getElementById('profileUsername').textContent = username;
document.getElementById('profileStoriesCount').textContent = profile.stats.stories;
document.getElementById('profileCommentsCount').textContent = profile.stats.comments;
document.getElementById('profileLikesCount').textContent = profile.stats.likes;

// Hikayeler sekmesi
const storiesTab = document.getElementById('storiesTab');
storiesTab.innerHTML = '';

if (profile.stories.length === 0) {
storiesTab.innerHTML = '<div class="empty-state"><p>Hen√ºz hikaye payla≈üƒ±lmamƒ±≈ü</p></div>';
} else {
profile.stories.forEach(story => {
const commentCount = this.comments.filter(c => c.storyId === story.id).length;
const card = document.createElement('div');
card.className = 'story-card';
card.style.marginBottom = '1rem';
card.innerHTML = `
                           <div class="story-title">${this.escapeHtml(story.title)}</div>
                           <div class="story-preview">${this.escapeHtml(story.content.substring(0, 150))}</div>
                           <div class="story-meta">
                               <span>${story.date}</span>
                               <span>${story.category}</span>
                           </div>
                           <button class="btn" style="width: 100%; margin-top: 1rem;" onclick="app.viewStory(${story.id})">
                               <i class="fas fa-eye"></i> Hikayeyi Oku
                           </button>
                       `;
storiesTab.appendChild(card);
});
}

// Yorumlar sekmesi
const commentsTab = document.getElementById('commentsTab');
commentsTab.innerHTML = '';

if (profile.comments.length === 0) {
commentsTab.innerHTML = '<div class="empty-state"><p>Hen√ºz yorum yapƒ±lmamƒ±≈ü</p></div>';
} else {
profile.comments.forEach(comment => {
const card = document.createElement('div');
card.className = 'comment-card';
card.style.marginBottom = '1rem';
card.innerHTML = `
                           <div class="comment-header">
                               <span class="comment-date">${comment.date}</span>
                           </div>
                           <div class="comment-text">${this.escapeHtml(comment.text)}</div>
                           <button class="btn btn-secondary" style="width: 100%; margin-top: 1rem;" onclick="app.viewStory(${comment.storyId})">
                               <i class="fas fa-arrow-right"></i> Hikayeyi Oku
                           </button>
                       `;
commentsTab.appendChild(card);
});
}
}

            addChatMessage(text) {
                if (!this.currentUser || !text.trim()) return;
                const msg = {
                    id: Date.now(),
                    author: this.currentUser.username,
                    text: text.trim(),
                    date: new Date().toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' })
                };
                this.chatMessages.push(msg);
                this.save();
                this.renderChat();
            }

            renderChat() {
                const container = document.getElementById('chatMessages');
                if (!container) return;
                container.innerHTML = '';
                this.chatMessages.slice(-50).forEach(msg => {
                    const div = document.createElement('div');
                    div.style.cssText = 'margin-bottom: 1rem; padding: 0.8rem; background: rgba(100, 50, 100, 0.3); border-left: 3px solid #ff9999; border-radius: 6px;';
                    div.innerHTML = `
                        <div style="color: #ff9999; font-weight: bold; font-size: 0.9rem;"><i class="fas fa-user-circle"></i> ${this.escapeHtml(msg.author)}</div>
                        <div style="color: #d0d0d0; margin-top: 0.3rem; word-break: break-word;">${this.escapeHtml(msg.text)}</div>
                        <div style="color: #888; font-size: 0.8rem; margin-top: 0.3rem;">${msg.date}</div>
                    `;
                    container.appendChild(div);
                });
                container.scrollTop = container.scrollHeight;
            }

            toggleSaveStory(storyId) {
                if (!this.currentUser) {
                    showToast('Kaydetmek i√ßin giri≈ü yapƒ±nƒ±z!');
                    return;
                }
                const idx = this.savedStoryIds.indexOf(storyId);
                if (idx > -1) {
                    this.savedStoryIds.splice(idx, 1);
                    showToast('K√ºt√ºphaneden kaldƒ±rƒ±ldƒ±');
                } else {
                    this.savedStoryIds.push(storyId);
                    showToast('K√ºt√ºphaneye eklendi');
                }
                this.save();
                this.renderLibrary();
                this.renderStories();
            }

            renderLibrary() {
                const container = document.getElementById('libraryContainer');
                if (!container) return;
                container.innerHTML = '';
                
                if (!this.currentUser) {
                    container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><p>Giri≈ü yapƒ±nƒ±z</p></div>';
                    return;
                }

                const savedStories = this.allStories.filter(s => this.savedStoryIds.includes(s.id));

                if (savedStories.length === 0) {
                    container.innerHTML = '<div class="empty-state" style="grid-column: 1/-1;"><p>Hen√ºz kaydedilmi≈ü hikaye yok</p></div>';
                    return;
                }

                savedStories.forEach(story => {
                    const card = document.createElement('div');
                    card.className = 'story-card';
                    card.innerHTML = `
                        <div class="story-title">${this.escapeHtml(story.title)}</div>
                        <div class="story-preview">${this.escapeHtml(story.content.substring(0, 100))}</div>
                        <div class="story-meta">
                            <span class="story-author">${this.escapeHtml(story.author)}</span>
                        </div>
                        <div class="story-actions">
                            <button class="action-btn" onclick="app.viewStory(${story.id})" style="flex: 1;">
                                <i class="fas fa-eye"></i> Oku
                            </button>
                            <button class="action-btn saved" onclick="app.toggleSaveStory(${story.id})" style="flex: 1;">
                                <i class="fas fa-trash"></i> √áƒ±kar
                            </button>
                        </div>
                    `;
                    container.appendChild(card);
                });
            }

escapeHtml(text) {
const map = {
'&': '&amp;',
'<': '&lt;',
'>': '&gt;',
'"': '&quot;',
"'": '&#039;'
};
return text.replace(/[&<>"']/g, m => map[m]);
}
}

/// ===== KULLANICI ƒ∞≈ûLEMLERƒ∞ =====
async function login() {
    const email = document.getElementById('loginEmail').value.trim();
    const password = document.getElementById('loginPassword').value;

    if (!email || !password) {
        showToast('L√ºtfen t√ºm alanlarƒ± doldurunuz!');
        return;
    }

    try {
        // Yeni SDK'da login bu ≈üekilde yapƒ±lƒ±r:
        const session = await account.createSession(email, password);

        const user = await account.get();
        app.currentUser = user;
        app.save();
        app.updateUI();
        toggleAuth();

        showToast(`Ho≈ügeldiniz ${user.name || email}!`);

    } catch (error) {
        showToast('Giri≈ü hatasƒ±: ' + error.message);
    }
}


// Formu temizle
document.getElementById('loginUsername').value = '';
document.getElementById('loginPassword').value = '';


async function register() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;

    if (!username || !email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        await account.create(
            Appwrite.ID.unique(),
            email,
            password,
            username // displayName olarak kaydediliyor
        );

        showToast("Kayƒ±t ba≈üarƒ±lƒ±! ≈ûimdi giri≈ü yapabilirsiniz.");
        toggleAuth();

    } catch (error) {
        showToast("Hata: " + error.message);
    }
// Formu temizle
document.getElementById('registerUsername').value = '';
document.getElementById('registerEmail').value = '';
document.getElementById('registerPassword').value = '';
}

function logout() {
app.currentUser = null;
app.save();
app.updateUI();
showPage('home');
showToast('√áƒ±kƒ±≈ü yapƒ±ldƒ±!');
}

function toggleAuth() {
const modal = document.getElementById('authModal');
modal.classList.toggle('show');
}

function switchAuthForm() {
document.getElementById('loginForm').style.display = 
document.getElementById('loginForm').style.display === 'none' ? 'block' : 'none';
document.getElementById('registerForm').style.display = 
document.getElementById('registerForm').style.display === 'none' ? 'block' : 'none';
}

// ===== Hƒ∞KAYE ƒ∞≈ûLEMLERƒ∞ =====
function showAddStoryModal() {
if (!app.currentUser) {
showToast('Hikaye eklemek i√ßin giri≈ü yapƒ±nƒ±z!');
return;
}
document.getElementById('addStoryModal').classList.add('show');
}

function closeAddStoryModal() {
document.getElementById('addStoryModal').classList.remove('show');
document.getElementById('storyTitle').value = '';
document.getElementById('storyContent').value = '';
}

function addStory() {
const title = document.getElementById('storyTitle').value.trim();
const category = document.getElementById('storyCategory').value;
const content = document.getElementById('storyContent').value.trim();

if (app.addNewStory(title, category, content)) {
closeAddStoryModal();
showPage('home');
}
}

function filterStories() {
app.filterAndSortStories();
}

function handleSearchInput() {
const searchInput = document.getElementById('searchInput');
const wrapper = searchInput.parentElement;

if (searchInput.value) {
wrapper.classList.add('has-text');
} else {
wrapper.classList.remove('has-text');
}
}

function clearSearch() {
document.getElementById('searchInput').value = '';
const wrapper = document.getElementById('searchInput').parentElement;
wrapper.classList.remove('has-text');
filterStories();
}

function resetFilters() {
document.getElementById('searchInput').value = '';
document.getElementById('searchTypeFilter').value = 'all';
document.getElementById('categoryFilter').value = '';
document.getElementById('sortFilter').value = 'newest';

const wrapper = document.getElementById('searchInput').parentElement;
wrapper.classList.remove('has-text');

filterStories();
showToast('Filtreleri sƒ±fƒ±rlandƒ±!');
}

function filterByCategory(category) {
if (category === 'T√ºm') {
document.getElementById('categoryFilter').value = '';
} else {
document.getElementById('categoryFilter').value = category;
}
filterStories();
}

// ===== YORUM ƒ∞≈ûLEMLERƒ∞ =====
function addComment() {
const text = document.getElementById('commentText').value.trim();
if (app.addNewComment(text)) {
document.getElementById('commentText').value = '';
}
}

// ===== SAYFA NAVƒ∞GASYONU =====
function showPage(pageName) {
document.querySelectorAll('.page').forEach(page => {
page.classList.remove('active');
});
            
            // Sayfaya √∂zel i≈ülemler
            if (pageName === 'library') {
                app.renderLibrary();
            } else if (pageName === 'chat') {
                app.renderChat();
            } else if (pageName === 'home') {
                app.filterAndSortStories();
            }
            
document.getElementById(pageName).classList.add('active');

// Modal'larƒ± kapat
document.getElementById('authModal').classList.remove('show');
document.getElementById('addStoryModal').classList.remove('show');
}

function showUserProfile() {
if (app.currentUser) {
app.renderUserProfile(app.currentUser.username);
showPage('userProfile');
}
}

        function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value;
            if (text.trim()) {
                app.addChatMessage(text);
                input.value = '';
            }
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                sendChatMessage();
                event.preventDefault();
            }
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mainMenu');
            menu.classList.toggle('mobile-open');
        }

// ===== PROFILE SEKMELER =====
function switchProfileTab(tab) {
document.querySelectorAll('.profile-tab').forEach(t => t.classList.remove('active'));
document.querySelectorAll('.profile-content').forEach(c => c.classList.remove('active'));

event.target.closest('.profile-tab').classList.add('active');
document.getElementById(tab + 'Tab').classList.add('active');
}

// ===== UTILS =====
function showToast(message) {
const toast = document.createElement('div');
toast.className = 'toast';
toast.textContent = message;
document.body.appendChild(toast);

setTimeout(() => {
toast.remove();
}, 3000);
}

// ===== ƒ∞Nƒ∞Tƒ∞YALƒ∞ZASYON =====
let app;
document.addEventListener('DOMContentLoaded', () => {
app = new ForumApp();

// Modal dƒ±≈üƒ±na tƒ±klama
document.getElementById('authModal').addEventListener('click', (e) => {
if (e.target.id === 'authModal') toggleAuth();
});

document.getElementById('addStoryModal').addEventListener('click', (e) => {
if (e.target.id === 'addStoryModal') closeAddStoryModal();
});

document.getElementById('editStoryModal').addEventListener('click', (e) => {
if (e.target.id === 'editStoryModal') app.closeEditStoryModal();
});

// Enter tu≈üu
document.getElementById('commentText').addEventListener('keydown', (e) => {
if (e.ctrlKey && e.key === 'Enter') {
addComment();
}
});
});

// Beƒüeni toggle (detail sayfasƒ±nda)
function toggleLikeStory() {
app.toggleLikeStory();
}
</script>



<!-- Footer -->
<footer>
<div class="footer-content">
<div class="footer-title">
<i class="fas fa-user-circle"></i> Korku Forumu Sahibi
</div>
<div class="footer-social">
<a href="https://instagram.com/emirslmn_" target="_blank" class="social-link" title="Instagram">
<i class="fab fa-instagram"></i>
Instagram
</a>
<a href="https://github.com/ermirhansalman4" target="_blank" class="social-link" title="GitHub">
<i class="fab fa-github"></i>
GitHub
</a>
</div>
<div class="footer-text">
<p>¬© 2026 Korku Hikayeleri Forumu - T√ºm Haklarƒ± Saklƒ±dƒ±r</p>
</div>
</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/appwrite@8.6.0/dist/appwrite.min.js"></script>

<script>
const { Client, Account, Databases, ID } = Appwrite;

const client = new Appwrite.Client()
    .setEndpoint("https://cloud.appwrite.io/v1")
    .setProject("698ddf380033ce2ca5d7");
    
    

const account = new Appwrite.Account(client);
const databases = new Databases(client);

const DATABASE_ID = "698de2e0003c0f3283ae";
const STORIES_COLLECTION_ID = "stories";
const COMMENTS_COLLECTION_ID = "comments";
</script>
<script>

// ===== REGISTER =====
async function register() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;

    if (!username || !email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        await account.create(
            Appwrite.ID.unique(), // benzersiz kullanƒ±cƒ± ID
            email,
            password,
            username // displayName olarak kaydediliyor
        );

        showToast("Kayƒ±t ba≈üarƒ±lƒ±! ≈ûimdi giri≈ü yapabilirsiniz.");
        toggleAuth();
    } catch (error) {
        showToast("Hata: " + error.message);
    }
}


// ===== LOGIN =====
async function login() {
    const username = document.getElementById("registerUsername").value.trim();
    const email = document.getElementById("registerEmail").value.trim();
    const password = document.getElementById("registerPassword").value;


    if (!email || !password) {
        showToast("L√ºtfen t√ºm alanlarƒ± doldurunuz!");
        return;
    }

    try {
        // 8.6.0 s√ºr√ºm√ºnde login
        await account.createSession(email, password);

        const user = await account.get();
        app.currentUser = user;
        app.save();
        app.updateUI();
        toggleAuth();

        showToast(`Ho≈ügeldiniz ${user.name || email}!`);
    } catch (error) {
        showToast("Giri≈ü hatasƒ±: " + error.message);
    }
}

// ===== LOGOUT =====
async function logout() {
    try {
        await account.deleteSession("current");
        location.reload();
    } catch (error) {
        showToast("√áƒ±kƒ±≈ü hatasƒ±: " + error.message);
    }
}

</script>


</body>
</html>
